<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OpenNSL API Guide and Reference Manual: examples/dpp/example_policer.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen_brcm.css" rel="stylesheet" type="text/css" />
<link href="tabs_brcm.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenNSL API Guide and Reference Manual
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Welcome</span></a></li>
      <li><a href="pages.html"><span>OpenNSL&#160;Documentation</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d28a4824dc47e487b107a5db32ef43c4.html">examples</a></li><li class="navelem"><a class="el" href="dir_3b907af6788adb4a007b7e829369d3f2.html">dpp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">example_policer.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="dpp_2example__policer_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*********************************************************************</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * (C) Copyright Broadcom Corporation 2013-2017</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *  you may not use this file except in compliance with the License.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *  You may obtain a copy of the License at</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *      http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *  See the License for the specific language governing permissions and</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *  limitations under the License.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> **********************************************************************</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * \file         example_policer.c</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * \brief        OpenNSL example application for policer or service meter</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * \details       In this example, we will create a simple single rate, three color policer. </span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> *                This policer will be attached to a Field Processor rule that counts </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> *                packets ingressing with a specific destination MAC address. </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> *                If single_rate=1 - meter mode is opennslPolicerModeSrTcm (single rate 3 colors), </span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> *                the excess bucket has no credits of its own and it only receives excess credits </span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> *                from the committed bucket run ethernet packet with DA 1 and vlan tag id 1 from </span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> *                in_port, with:</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> *                1) priority = 1:</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> *                     the stream will go through the committed bucket and afterwards also through </span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> *                     the excess bucket for single_rate: the stream will arrive at out_port with </span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> *                     30M rate (EIR has no credits).</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> *                2) priority = 4: </span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> *                     the stream will go straight to the excess bucket and arrive at out_port with </span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> *                     20M rate</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> *      Note: Stats processor is set based on the core. Use ports belonging to core=0(1 through 20)</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> *      Create VLAN 100 and add input port and output port in the VLAN</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> *             vlan create 100 PortBitMap=xe2,xe3 </span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> **********************************************************************/</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="opennsl_2error_8h.html">opennsl/error.h</a>&gt;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="init_8h.html">opennsl/init.h</a>&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="opennsl_2port_8h.html">opennsl/port.h</a>&gt;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="l2_8h.html">opennsl/l2.h</a>&gt;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="vlan_8h.html">opennsl/vlan.h</a>&gt;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="field_8h.html">opennsl/field.h</a>&gt;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="policer_8h.html">opennsl/policer.h</a>&gt;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="cosqX_8h.html">opennsl/cosqX.h</a>&gt;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="examples_2util_8h.html">examples/util.h</a>&gt;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="code" href="dpp_2example__policer_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">   61</a></span>&#160;<span class="keywordtype">char</span> <a class="code" href="example__cos_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">example_usage</a>[] =</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="stringliteral">&quot;Syntax: example_policer                                                \n\r&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="stringliteral">&quot;                                                                       \n\r&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="stringliteral">&quot;Paramaters: None.                                                      \n\r&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="stringliteral">&quot;                                                                       \n\r&quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="stringliteral">&quot;Example: The following command is used to create a policer and attach  \n\r&quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="stringliteral">&quot;         it to a field processor rule matching traffic with            \n\r&quot;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="stringliteral">&quot;         destination MAC = MAC_DA.                                     \n\r&quot;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="stringliteral">&quot;         It also provides an option to display the number of packets   \n\r&quot;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="stringliteral">&quot;         redirected to destination port.                               \n\r&quot;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="stringliteral">&quot;                                                                       \n\r&quot;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="stringliteral">&quot;         example_policer                                               \n\r&quot;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="stringliteral">&quot;                                                                       \n\r&quot;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="stringliteral">&quot;Usage Guidelines: None.                                                \n\r&quot;</span>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="code" href="dpp_2example__policer_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">   76</a></span>&#160;<span class="preprocessor">#define DEFAULT_UNIT 0</span></div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="code" href="dpp_2example__policer_8c.html#a91668ed1245d073a2ac84e6121205d28">   77</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DEFAULT_VLAN 1</span></div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="code" href="dpp_2example__policer_8c.html#a074e4c6c5b35a6e7df06fbc024b0760d">   78</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define MAC_DA        {0x00, 0x00, 0x00, 0x00, 0x00, 0x01}</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor"></span><span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="code" href="dpp_2example__policer_8c.html#a523822b8d626fa4bcd6cfa36a6d8c0be">   80</a></span>&#160;<span class="preprocessor">#define MAC_MASK      {0xff, 0xff, 0xff, 0xff, 0xff, 0xff}</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor"></span><span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="code" href="dpp_2example__policer_8c.html#ae1f8e7ccbc1a30485b63b662315eb49c">   84</a></span>&#160;<a class="code" href="group__types.html#gac91c9cde19d67513d4d7a5693f0d1fa4" title="opennsl_policer_t">opennsl_policer_t</a> <a class="code" href="dpp_2example__policer_8c.html#ae1f8e7ccbc1a30485b63b662315eb49c">policer_id</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="code" href="dpp_2example__policer_8c.html#a31bf8ad94a92b00a66bc7e32e1ba7c98">   85</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="example__field__redirect_8c.html#a31bf8ad94a92b00a66bc7e32e1ba7c98">stat_id</a>                = 2;</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="code" href="dpp_2example__policer_8c.html#a6c55b5e23edc21bd23828117f2babe59">   86</a></span>&#160;<a class="code" href="group__types.html#ga265033c7aaf6d915b6aa85b49e6ecaf1" title="opennsl_field_stat_e">opennsl_field_stat_t</a> <a class="code" href="dpp_2example__policer_8c.html#a6c55b5e23edc21bd23828117f2babe59">accept_stats</a> = <a class="code" href="group__types.html#gga4e242bb4676be2d7083bd25738f65aafad171d8f929e45ceb4dc9527a8b5d6279" title="Packet count of accepted traffic of all colors.">opennslFieldStatAcceptedPackets</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="code" href="dpp_2example__policer_8c.html#a871b3c025a8b037a7eaa43265b8639d9">   87</a></span>&#160;<a class="code" href="group__types.html#ga265033c7aaf6d915b6aa85b49e6ecaf1" title="opennsl_field_stat_e">opennsl_field_stat_t</a> <a class="code" href="dpp_2example__policer_8c.html#a871b3c025a8b037a7eaa43265b8639d9">drop_stats</a> = <a class="code" href="group__types.html#gga4e242bb4676be2d7083bd25738f65aafad5bf7753c9c539ea22b69d0b3994babd" title="Packet count of dropped traffic of all colors.">opennslFieldStatDroppedPackets</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<a class="code" href="group__error.html#gac798c5c818a3213c27d2900d47add7f9" title="OPENNSL API error codes.">opennsl_error_t</a></div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="code" href="dpp_2example__policer_8c.html#aa4320dfff072ae795431d11fc2cd76fb">   90</a></span>&#160;<a class="code" href="dpp_2example__policer_8c.html#aa4320dfff072ae795431d11fc2cd76fb">example_create_meter</a>(<span class="keywordtype">int</span> unit) </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">int</span> rv;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="structopennsl__info__s.html" title="OPENNSL Information structure.">opennsl_info_t</a> info;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="structopennsl__policer__config__s.html">opennsl_policer_config_t</a> pol_cfg;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  rv = <a class="code" href="group__init.html#ga64691ef7b923460206cd9abb675807c0" title="Get information about a OPENNSL unit.">opennsl_info_get</a>(unit, &amp;info);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__error.html#ga655eb72518850235a4c759ddceb622e6">OPENNSL_FAILURE</a>(rv)) </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    printf(<span class="stringliteral">&quot;Error in opennsl_info_get, rv=%d\n&quot;</span>, rv);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">/* create policer 1 */</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="group__policer.html#ga91761860f3bc8d45c400f0df15c5ebb8" title="Initialize a policer configuration structure.">opennsl_policer_config_t_init</a>(&amp;pol_cfg);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  pol_cfg.<a class="code" href="structopennsl__policer__config__s.html#ad68ece54793c13998c4fbc57da4c9f1d" title="Policer mode.">mode</a> = <a class="code" href="group__policer.html#gga4f914affbe1d6b845ee39c41ef2decd0a4fdd8f4cdb6ea261bf5b7cec2e57e774" title="RFC 2697.">opennslPolicerModeSrTcm</a>; <span class="comment">/* single rate three colors mode */</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  pol_cfg.<a class="code" href="structopennsl__policer__config__s.html#a0234c298242cb9c97edf38839cee39e2" title="Committed rate (kbits per sec).">ckbits_sec</a> = 30000; <span class="comment">/* 30Mbps */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  pol_cfg.<a class="code" href="structopennsl__policer__config__s.html#a6192654a85f674180fa00e496f21cbb2" title="Committed burst size (kbits).">ckbits_burst</a> = 1000;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  pol_cfg.<a class="code" href="structopennsl__policer__config__s.html#a45403bdbdaa193dfb2d2d872dcb65b33" title="Peak burst size (kbits).">pkbits_burst</a> = 1000;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  pol_cfg.<a class="code" href="structopennsl__policer__config__s.html#a42754fa5db85201067f5365b3d7da302" title="Maximum Peak rate (kbits per sec), Applicable only for cascade mode.">max_pkbits_sec</a> = 20000; <span class="comment">/* 20Mbps max */</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  rv = <a class="code" href="group__policer.html#gac1d0dc00c9ebbf0a1b263ded965e9915" title="Create a policer entry.">opennsl_policer_create</a>(unit, &amp;(pol_cfg), &amp;(<a class="code" href="dpp_2example__policer_8c.html#ae1f8e7ccbc1a30485b63b662315eb49c">policer_id</a>));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    printf(<span class="stringliteral">&quot;Error in opennsl_policer_create no. 1, rv=%d\n&quot;</span>,rv);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  printf(<span class="stringliteral">&quot;policer_id1: %d\n&quot;</span>, <a class="code" href="dpp_2example__policer_8c.html#ae1f8e7ccbc1a30485b63b662315eb49c">policer_id</a>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<a class="code" href="group__error.html#gac798c5c818a3213c27d2900d47add7f9" title="OPENNSL API error codes.">opennsl_error_t</a> </div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="code" href="dpp_2example__policer_8c.html#a6b75bad6242820d8c47be3a04a6ba24b">  126</a></span>&#160;<a class="code" href="dpp_2example__policer_8c.html#a6b75bad6242820d8c47be3a04a6ba24b">example_create_policy</a>(<span class="keywordtype">int</span> unit, <a class="code" href="group__types.html#gacaeba2b4ddbc89b0e556720a9388885f" title="Set the default tag protocol ID (TPID) for the specified port.">opennsl_port_t</a> in_port, <a class="code" href="group__types.html#gacaeba2b4ddbc89b0e556720a9388885f" title="Set the default tag protocol ID (TPID) for the specified port.">opennsl_port_t</a> out_port) </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;{</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">int</span> rv;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordtype">int</span> group_priority = 6;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="group__field.html#ga4387a1b4682c605fcc1a2b8297f8a404" title="Opaque handle to a field group.">opennsl_field_group_t</a> <a class="code" href="example__field__redirect_8c.html#ae05d96b029e63f2deae4f883fb46726d">grp</a> = 1;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="structopennsl__field__qset__s.html" title="Field qset defines the set of fields used for lookup.">opennsl_field_qset_t</a> qset;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="structopennsl__field__aset__s.html" title="Used to specify the actions that can be taken by the entries in a group.">opennsl_field_aset_t</a> aset;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="group__field.html#ga699caff1a232fe42e6668e5d2869e61e" title="Opaque handle to a field entry.">opennsl_field_entry_t</a> ent;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="group__types.html#ga265033c7aaf6d915b6aa85b49e6ecaf1" title="opennsl_field_stat_e">opennsl_field_stat_t</a> <a class="code" href="example__field__redirect_8c.html#ab30be53fb3407849f0fac2f490911c1f">stats</a>[2];</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordtype">int</span> statId;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="structopennsl__l2__addr__s.html" title="Device-independent L2 address structure.">opennsl_l2_addr_t</a> l2addr;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a> mac = <a class="code" href="dpp_2example__policer_8c.html#a074e4c6c5b35a6e7df06fbc024b0760d">MAC_DA</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a> mask = <a class="code" href="dpp_2example__policer_8c.html#a523822b8d626fa4bcd6cfa36a6d8c0be">MAC_MASK</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">/* map packet to meter_id, according to in-port and dst-port */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="group__field.html#ga37e97efc912030850263af8ef6248443">OPENNSL_FIELD_QSET_INIT</a>(qset);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="group__field.html#gae7dc7300f0a4b3add5d9099b52eaf735">OPENNSL_FIELD_QSET_ADD</a>(qset, <a class="code" href="group__field.html#ggaa519dd558cda3869447bd6e1209b8ce4ab1700b0457705169d5cd3227404761bf" title="Destination L2 MAC Address.">opennslFieldQualifyDstMac</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  rv = <a class="code" href="group__field.html#ga724e490c5293940db0bcf62208fb9baf" title="Create a field group.">opennsl_field_group_create_mode_id</a>(unit, qset, group_priority, <a class="code" href="group__field.html#ggaa5747a2e53f2ae8b0507e40508e3b292a5d6ab9cb3b3e7a9fb7e18cffbf4f41c6" title="Auto-expand group based on Qset (default).">opennslFieldGroupModeAuto</a>, grp);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    printf(<span class="stringliteral">&quot;Error in opennsl_field_group_create_mode_id. rv=%d \n&quot;</span>,rv);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="group__field.html#gaade393b183413ecfa854bcfe0d4e0da4">OPENNSL_FIELD_ASET_INIT</a>(aset);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="group__field.html#ga069ead7d7b8463459bc9ff678cfe2485">OPENNSL_FIELD_ASET_ADD</a>(aset, <a class="code" href="group__field.html#gga7e4b15dc0ad1411548bfbaff998cb97fa53f27966995a4a6fec12025009754006" title="Apply policer (policerId in param0) to traffic hitting this entry.">opennslFieldActionPolicerLevel0</a>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="group__field.html#ga069ead7d7b8463459bc9ff678cfe2485">OPENNSL_FIELD_ASET_ADD</a>(aset, <a class="code" href="group__field.html#gga7e4b15dc0ad1411548bfbaff998cb97fad0bc6993469025940c2558ef975e15c5" title="Specify/override where policer result will be used for matched packets.">opennslFieldActionUsePolicerResult</a>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="group__field.html#ga069ead7d7b8463459bc9ff678cfe2485">OPENNSL_FIELD_ASET_ADD</a>(aset, <a class="code" href="group__field.html#gga7e4b15dc0ad1411548bfbaff998cb97faa54a14fba38183f498eb1638d772c4cf" title="Update statistics (statId in param0) on entry hit.">opennslFieldActionStat0</a>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  rv = <a class="code" href="group__field.html#gaead4ec9137a60ab402a82391bcbfaa83" title="Change or retrieve the actions for a field group.">opennsl_field_group_action_set</a>(unit, grp, aset);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    printf(<span class="stringliteral">&quot;Error in opennsl_field_group_action_set. rv=%d \n&quot;</span>,rv);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  rv = <a class="code" href="group__field.html#gac6491132b08dde21c8a22ef703744d8e" title="Create a blank field entry.">opennsl_field_entry_create</a>(unit, grp, &amp;ent);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    printf(<span class="stringliteral">&quot;Error in opennsl_field_entry_create. rv=%d\n&quot;</span>,rv);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  rv = <a class="code" href="group__field.html#gaa95056ca152dd574025fd5aaa9b786bc">opennsl_field_qualify_DstMac</a>(unit, ent, mac, mask);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    printf(<span class="stringliteral">&quot;Error in opennsl_field_qualify_DstMac. rv=%d\n&quot;</span>,rv);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  stats[0] = <a class="code" href="group__types.html#gga4e242bb4676be2d7083bd25738f65aafad171d8f929e45ceb4dc9527a8b5d6279" title="Packet count of accepted traffic of all colors.">opennslFieldStatAcceptedPackets</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  stats[1] = <a class="code" href="group__types.html#gga4e242bb4676be2d7083bd25738f65aafad5bf7753c9c539ea22b69d0b3994babd" title="Packet count of dropped traffic of all colors.">opennslFieldStatDroppedPackets</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  statId = <a class="code" href="example__field__redirect_8c.html#a31bf8ad94a92b00a66bc7e32e1ba7c98">stat_id</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  rv = <a class="code" href="group__field.html#ga3e7541a4a6cab0e6ed7a98c4f6a4fd7b" title="Create stat collection entity with specified Statistics entity ID value.">opennsl_field_stat_create_id</a>(unit, grp, 2, &amp;(stats[0]), statId);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    printf(<span class="stringliteral">&quot;Error in opennsl_field_stat_create. rv=%d \n&quot;</span>, rv);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  rv = <a class="code" href="group__field.html#gad262135567b2fd47ceb1af7b4ca5c620" title="Attach statistics entity to Field Processor entry.">opennsl_field_entry_stat_attach</a>(unit, ent, statId);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    printf(<span class="stringliteral">&quot;Error in opennsl_field_entry_stat_attach with ent %d. rv=%d\n&quot;</span>, ent, rv);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">/* Create the policer */</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  rv = <a class="code" href="dpp_2example__policer_8c.html#aa4320dfff072ae795431d11fc2cd76fb">example_create_meter</a>(unit);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    printf(<span class="stringliteral">&quot;\r\nFailed to create the meter. Error: %s\r\n&quot;</span>,</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  }  </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  rv = <a class="code" href="group__field.html#gad260788b3efb1eae8ff7f5e434767e87" title="Attach a policer to a field entry.">opennsl_field_entry_policer_attach</a>(unit, ent, 0, (<a class="code" href="dpp_2example__policer_8c.html#ae1f8e7ccbc1a30485b63b662315eb49c">policer_id</a> &amp; 0xffff));</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    printf(<span class="stringliteral">&quot;Error in opennsl_field_entry_policer_attach with policer_id %d. rv=%d \n&quot;</span>, <a class="code" href="dpp_2example__policer_8c.html#ae1f8e7ccbc1a30485b63b662315eb49c">policer_id</a>, rv);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  rv = <a class="code" href="group__field.html#gacca0f485d7654f4b0fadb2c5eef2a95f" title="Install all entries of a field group into the hardware tables.">opennsl_field_group_install</a>(unit, grp);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    printf(<span class="stringliteral">&quot;Error in opennsl_field_group_install. rv=%d \n&quot;</span>, rv);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">/* send traffic with DA=1 and Vlan tag id 100 to out_port */</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <a class="code" href="group__l2.html#ga47e819cf5939a8e643ad09505df52071" title="Initialize an L2 address structure to a specified MAC address and VLAN ID.">opennsl_l2_addr_t_init</a>(&amp;l2addr, mac, 100);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  l2addr.<a class="code" href="structopennsl__l2__addr__s.html#a7546884120ba8ab5dce9348fd9bd819f" title="Zero-based port number.">port</a> = out_port;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  rv = <a class="code" href="group__l2.html#ga4b8920c1c3cf4c0c59bf8f0c5890f7c5" title="Add an L2 address entry to the specified device.">opennsl_l2_addr_add</a>(unit, &amp;l2addr);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    printf(<span class="stringliteral">&quot;Error, opennsl_l2_addr_add with vid 1. rv=%d \n&quot;</span>, rv);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">/* </span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">   * map Vlan tag proirity=4 and cfi=0 to yellow color:</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">   * this will mean that the packet will arrive with a yellow color instead of green </span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">   * if meter mode is not COLOR_BLIND, the packet will go straight to the excess bucket </span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">   * (without going through the committed bucket) </span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  rv = <a class="code" href="group__port.html#ga15667a93ccb19b29d1e6509a5932e73e">opennsl_port_vlan_priority_map_set</a>(unit, in_port, 4 <span class="comment">/* priority */</span>, 0 <span class="comment">/* cfi */</span>, </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;              1 <span class="comment">/* internal priority */</span>, <a class="code" href="group__types.html#ggab05e850eabb21ae43c3814f22adfc486a2e70ad0ee5548a17d98da998983d116d">opennslColorYellow</a> <span class="comment">/* color */</span>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    printf(<span class="stringliteral">&quot;Error, opennsl_port_vlan_priority_map_set with prio 4. rv=%d \n&quot;</span>, rv);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">/* </span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">   * map Vlan tag proirity=1 and cfi=0 to green color:</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">   * packet that will arrive with a green color will go through the committed bucket </span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">   * and the excess bucket </span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  rv = <a class="code" href="group__port.html#ga15667a93ccb19b29d1e6509a5932e73e">opennsl_port_vlan_priority_map_set</a>(unit, in_port, 1 <span class="comment">/* priority */</span>, 0 <span class="comment">/* cfi */</span>, </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;              0 <span class="comment">/* internal priority */</span>, <a class="code" href="group__types.html#ggab05e850eabb21ae43c3814f22adfc486ab02e93ac50c8c32306e9a6b88664b216">opennslColorGreen</a> <span class="comment">/* color */</span>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    printf(<span class="stringliteral">&quot;Error, opennsl_port_vlan_priority_map_set with prio 1. rv=%d \n&quot;</span>, rv);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">/* set discard DP to drop all packets with DP = 3 */</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  rv = <a class="code" href="group__cosq.html#ga7f06994a80a1a4cbc5986ce34b1d60af" title="Configure Weighted Random Early Discard (WRED).">opennsl_cosq_discard_set</a>(unit, <a class="code" href="group__cosq.html#gaaf2b5ff9e0ad1a0cc72a3059e2968931">OPENNSL_COSQ_DISCARD_ENABLE</a> | <a class="code" href="group__cosq.html#ga29d08ef127ac209c9c82eb2b1cdaa674">OPENNSL_COSQ_DISCARD_COLOR_BLACK</a>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    printf(<span class="stringliteral">&quot;Error, opennsl_cosq_discard_set. rv=%d \n&quot;</span>, rv);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;}</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="code" href="dpp_2example__policer_8c.html#a0ddf1224851353fc92bfbff6f499fa97">  271</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="example__cos_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function for policer application.">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;{</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordtype">int</span> rv = 0;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordtype">int</span> unit = <a class="code" href="dpp_2example__policer_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">DEFAULT_UNIT</a>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordtype">int</span> choice;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <a class="code" href="sal_2types_8h.html#aa3ad64cf41ec3a042bd92550cc6ed308">uint64</a> val;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordtype">int</span> inport, outport;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordflow">if</span>((argc != 1) || ((argc &gt; 1) &amp;&amp; (strcmp(argv[1], <span class="stringliteral">&quot;--help&quot;</span>) == 0))) </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    printf(<span class="stringliteral">&quot;%s\n\r&quot;</span>, <a class="code" href="example__cos_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">example_usage</a>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a8b380efdb47b4a4b0ebafbb1c7823748">OPENNSL_E_PARAM</a>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="comment">/* Initialize the system. */</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  rv = <a class="code" href="driver_8h.html#a06a6fe41f5ea8664c461423d3cad0923" title="Function to initialize the switch.">opennsl_driver_init</a>((<a class="code" href="structopennsl__config__s.html">opennsl_init_t</a> *) <a class="code" href="sal_2types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">if</span>(rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    printf(<span class="stringliteral">&quot;\r\nFailed to initialize the system. Error: %s\r\n&quot;</span>,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;           <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="comment">/* cold boot initialization commands */</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  rv = <a class="code" href="examples_2util_8h.html#a2846e8ec8f46d212a3ae2493bdff7980" title="Set default configuration (like STP state, speed/duplex) for all ports.">example_port_default_config</a>(unit);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    printf(<span class="stringliteral">&quot;\r\nFailed to apply default config on ports, rc = %d (%s).\r\n&quot;</span>,</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;           rv, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="comment">/* Add ports to default vlan. */</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  printf(<span class="stringliteral">&quot;Adding ports to default vlan.\r\n&quot;</span>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  rv = <a class="code" href="examples_2util_8h.html#a2d14e4de1f4a7192ac7e378f8f7c63ff" title="Add all ports to default vlan.">example_switch_default_vlan_config</a>(unit);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keywordflow">if</span>(rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    printf(<span class="stringliteral">&quot;\r\nFailed to add default ports. Error: %s\r\n&quot;</span>,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">while</span>(1) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    printf(<span class="stringliteral">&quot;\r\nUser menu: Select one of the following options\r\n&quot;</span>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    printf(<span class="stringliteral">&quot;1. Apply policer to the traffic\n&quot;</span>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    printf(<span class="stringliteral">&quot;2. Retrieve statistics of the policer\n&quot;</span>);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="preprocessor">#ifdef INCLUDE_DIAG_SHELL</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;9. Launch diagnostic shell\n&quot;</span>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;0. Quit the application.\r\n&quot;</span>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;choice) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">switch</span>(choice)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        printf(<span class="stringliteral">&quot;Enter the input port number(belonging to core-0):\n&quot;</span>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;inport) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;          printf(<span class="stringliteral">&quot;Invalid value entered. Please re-enter.\n&quot;</span>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        printf(<span class="stringliteral">&quot;Enter the output port number(belonging to core-0):\n&quot;</span>);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;outport) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;          printf(<span class="stringliteral">&quot;Invalid value entered. Please re-enter.\n&quot;</span>);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">/* Create policer and test traffic rate */</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  rv = <a class="code" href="dpp_2example__policer_8c.html#a6b75bad6242820d8c47be3a04a6ba24b">example_create_policy</a>(unit, inport, outport);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    printf(<span class="stringliteral">&quot;\r\nFailed to create the policer. Error: %s\r\n&quot;</span>,</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  }  </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        rv = <a class="code" href="group__field.html#gaf85528d51ba145198ff9be30d597814a" title="Get 64-bit counter value for specific statistic type.">opennsl_field_stat_get</a>(unit, <a class="code" href="example__field__redirect_8c.html#a31bf8ad94a92b00a66bc7e32e1ba7c98">stat_id</a>, <a class="code" href="dpp_2example__policer_8c.html#a6c55b5e23edc21bd23828117f2babe59">accept_stats</a>, &amp;val);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;          printf(<span class="stringliteral">&quot;Failed to get the accepted packets statistics, &quot;</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;              <span class="stringliteral">&quot;Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        printf(<span class="stringliteral">&quot;Number of packets accepted: %lld (0x%0x)\n&quot;</span>, val, val);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        val = 0;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        rv = <a class="code" href="group__field.html#gaf85528d51ba145198ff9be30d597814a" title="Get 64-bit counter value for specific statistic type.">opennsl_field_stat_get</a>(unit, <a class="code" href="example__field__redirect_8c.html#a31bf8ad94a92b00a66bc7e32e1ba7c98">stat_id</a>, <a class="code" href="dpp_2example__policer_8c.html#a871b3c025a8b037a7eaa43265b8639d9">drop_stats</a>, &amp;val);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;          printf(<span class="stringliteral">&quot;Failed to get the dropped packets statistics, &quot;</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;              <span class="stringliteral">&quot;Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        printf(<span class="stringliteral">&quot;Number of packets dropped: %lld (0x%0x)\n&quot;</span>, val, val);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="preprocessor">#ifdef INCLUDE_DIAG_SHELL</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">case</span> 9:</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        opennsl_driver_shell();</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        printf(<span class="stringliteral">&quot;Exiting the application.\n&quot;</span>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        rv = <a class="code" href="driver_8h.html#aa760e8f1af45c7fd27ec014b82c572f2" title="Function to free up the resources and exit the driver.">opennsl_driver_exit</a>();</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    } <span class="comment">/* End of switch */</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  } <span class="comment">/* End of while */</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;}</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<!--BEGIN GENERATE_TREEVIEW -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<hr>
<p>	
<table class="footer-brcm">
	<tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align=left></td>
		<td class="footer-brcm"><small><b>&copy;  2016-17 by Broadcom Limited. All rights reserved.</b></small>
			<div class="footer-brcm"><small>Broadcom Limited reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design. 
Information furnished by Broadcom Limited is believed to be accurate and reliable. However, Broadcom Limited does not assume any liability arising 
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license 
under its patent rights nor the rights of others. </small>
			</div>
		</td>
	</tr>
</table>	
</p>	
</div>
<!--END GENERATE_TREEVIEW-->
</body>
</html>
