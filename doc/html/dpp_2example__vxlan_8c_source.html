<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OpenNSL API Guide and Reference Manual: examples/dpp/example_vxlan.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen_brcm.css" rel="stylesheet" type="text/css" />
<link href="tabs_brcm.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenNSL API Guide and Reference Manual
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Welcome</span></a></li>
      <li><a href="pages.html"><span>OpenNSL&#160;Documentation</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d28a4824dc47e487b107a5db32ef43c4.html">examples</a></li><li class="navelem"><a class="el" href="dir_3b907af6788adb4a007b7e829369d3f2.html">dpp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">example_vxlan.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="dpp_2example__vxlan_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/******************************************************************************</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * (C) Copyright Broadcom Corporation 2017</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *  you may not use this file except in compliance with the License.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *  You may obtain a copy of the License at</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *      http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *  See the License for the specific language governing permissions and</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *  limitations under the License.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> ******************************************************************************</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * \file     example_vxlan.c</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * \brief    Example code for VxLAN application</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * VXLAN is a L2 VPN technology targeted for Data-Center communication </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * between Virtual Machines (VM) assigned to the same customer(Tenant) that are </span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * distributed in various racks in the Data-Center. L2VPN over IP/UDP tunnels can provide </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * E-LAN (similar to VPLS) and E-LINE (similar to VPWS) service. With VXLAN the ethernet </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * packets are encapsulated in UDP tunnels over an IP network. VXLAN uses UDP Source_Port</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * as multiplexing field for multiplexing multiple VPNs into the same UDP Tunnel.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * E-LINE is point-to-point service without support for Multicast traffic. In E-LINE, Ethernet</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> * frames are mapped into a VXLAN Tunnel based on incoming port plus packet header information. </span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * At the end of Tunnel, forwarding of Ethernet frames after Tunnel decapsulation is based on </span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * VXLAN-VNID and Tunnel lookup.</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> * In E-LAN, Ethernet frames of interest are also identified by incoming port plus packet </span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> * header information. Ethernet frames are switched into one or more VXLAN Tunnels based </span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> * on the MAC DA lookup.  At the end of  Tunnel, forwarding of Ethernet frames after Tunnel </span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> * decapsulation is based on the VXLAN-VNID and Tunnel lookup and frames are again forwarded </span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> * based on MAC-DA lookup.</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> * VXLAN VPN can be of type ELINE or ELAN.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> * For ELAN, a VPN is similar to a VLAN, which identifies a group of physical ports to be </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> * included in a broadcast domain. However, instead of physical ports, a ELAN VPN identifies </span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> * a group of &quot;virtual-ports&quot; to be included in a broadcast domain. In the VXLAN APIs, </span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> * a &quot;virtual-port&quot; is called an VXLAN port (see description below). The VPN ID is used to </span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> * qualify MAC DA lookups within the VPN.</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> * For ELINE, a VPN consists of two VXLAN ports. Packets arriving on one VXLAN port are sent </span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> * directly out the other VXLAN port.</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> * This example application creates a VxLAN segment:</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> *   VM1 --- Access Port --&gt; Segment (VPN) -&gt; network UDP tunnel --- VM2</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> * Setup configuration:</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> *   The following configuration needs to provided using platform configuration file (opennsl.cfg)</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> *   to run the VxLAN the application.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> *     bcm886xx_ip4_tunnel_termination_mode=0</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> *     bcm886xx_l2gre_enable=0</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"> *     bcm886xx_vxlan_enable=1</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"> *     bcm886xx_ether_ip_enable=0</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> *     bcm886xx_vxlan_tunnel_lookup_mode=2</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> *     split_horizon_forwarding_groups_mode=1</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"> * Testing Description:</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"> *   Packet from Access Port to Network Port (Packet encapsulation):</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> *     A packet sent from access port with parameters: Access VLAN = 200, SMAC = VM1 MAC,</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"> *     DMAC = VM2 MAC will be received on networking port with VxLAN encapsulation as follows:</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> *     SMAC = Switch MAC (00:0c:00:02:00:00), DMAC = Nexthop MAC (20:00:00:00:cd:1d)</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> *   Packet from Network Port to Access Port (Packet decapsulation):</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> *     A packet sent from network port with parameters: Tunnel VLAN = 20, SMAC = Router MAC</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">*     (20:00:00:00:cd:1d), DMAC = Switch MAC (00:0c:00:02:00:00), Destination UDP Port = 4789</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">       *     will be received on access port as follows:</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">       *     SMAC = VM2 MAC, DMAC = VM1 MAC</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">       *</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">       ******************************************************************************/</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="driver_8h.html">sal/driver.h</a>&gt;</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="opennsl_2error_8h.html">opennsl/error.h</a>&gt;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="init_8h.html">opennsl/init.h</a>&gt;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="l2_8h.html">opennsl/l2.h</a>&gt;</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="opennsl_2switch_8h.html">opennsl/switch.h</a>&gt;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="vlan_8h.html">opennsl/vlan.h</a>&gt;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="vswitch_8h.html">opennsl/vswitch.h</a>&gt;</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="tunnel_8h.html">opennsl/tunnel.h</a>&gt;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="multicast_8h.html">opennsl/multicast.h</a>&gt;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="vxlan_8h.html">opennsl/vxlan.h</a>&gt;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="examples_2util_8h.html">examples/util.h</a>&gt;</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">   93</a></span>&#160;<span class="preprocessor">#define DEFAULT_UNIT  0</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">   95</a></span>&#160;<span class="keywordtype">char</span> <a class="code" href="example__cos_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">example_usage</a>[] =</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="stringliteral">&quot;Syntax: example_vxlan                                                 \n\r&quot;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="stringliteral">&quot;                                                                      \n\r&quot;</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="stringliteral">&quot;Paramaters: None.                                                     \n\r&quot;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="stringliteral">&quot;                                                                      \n\r&quot;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="stringliteral">&quot;Usage Guidelines: None.                                               \n\r&quot;</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">/* Global Variables */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">  103</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> = 0; <span class="comment">/* To enable debug prints */</span></div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a8b5659941298c6f209a80a5bb61b6bf7">  104</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="example__cos_8c.html#a8b5659941298c6f209a80a5bb61b6bf7">egress_mc</a> = 0;</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a6501cefdf37aa8504bf40ad749d6691e">  105</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a6501cefdf37aa8504bf40ad749d6691e">outlif_to_count2</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#af6ad039dbf5967db3b9664ea9267d81a">  106</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#af6ad039dbf5967db3b9664ea9267d81a">outlif_counting_profile</a> = <a class="code" href="group__stat.html#gad5497a8abb099bc58967e3fb393f4388" title="An indicator for a LIF to be uncounted.">OPENNSL_STAT_LIF_COUNTING_PROFILE_NONE</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">/* Configure vxlan port */</span></div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="code" href="structvxlan__port__add__s.html">  109</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structvxlan__port__add__s.html">vxlan_port_add_s</a> {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">/* INPUT */</span></div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="code" href="structvxlan__port__add__s.html#a871ac564d33b78b193bba71ab8007acb">  111</a></span>&#160;  <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structvxlan__port__add__s.html#a871ac564d33b78b193bba71ab8007acb">vpn</a>;                   <span class="comment">/* vpn to which we add the vxlan port  */</span></div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="code" href="structvxlan__port__add__s.html#aa63b6f1c4a3906da1dd79446e2606d30">  112</a></span>&#160;  <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a> <a class="code" href="structvxlan__port__add__s.html#aa63b6f1c4a3906da1dd79446e2606d30">in_port</a>;          <span class="comment">/* network side port for learning info. */</span></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="code" href="structvxlan__port__add__s.html#ab32e0326829e5a9ebd5437a924286e9f">  113</a></span>&#160;  <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a> <a class="code" href="structvxlan__port__add__s.html#ab32e0326829e5a9ebd5437a924286e9f">in_tunnel</a>;        <span class="comment">/* ip tunnel terminator gport */</span></div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="code" href="structvxlan__port__add__s.html#a15fadc6bc382fbd97c2b669987ce0c5e">  114</a></span>&#160;  <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a> <a class="code" href="structvxlan__port__add__s.html#a15fadc6bc382fbd97c2b669987ce0c5e">out_tunnel</a>;       <span class="comment">/* ip tunnel initiator gport */</span></div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="code" href="structvxlan__port__add__s.html#a79ce4d83e6ef740255e7a2c76c8a05ad">  115</a></span>&#160;  <a class="code" href="group__types.html#gaca0e18617c36271957788ac01ba44c2e" title="opennsl_if_t">opennsl_if_t</a> <a class="code" href="structvxlan__port__add__s.html#a79ce4d83e6ef740255e7a2c76c8a05ad">egress_if</a>;           <span class="comment">/* FEC entry, contains ip tunnel encapsulation information */</span></div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="code" href="structvxlan__port__add__s.html#a65c03fc2e80c752f9caa54e9e4c7eb48">  116</a></span>&#160;  <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structvxlan__port__add__s.html#a65c03fc2e80c752f9caa54e9e4c7eb48">flags</a>;                 <span class="comment">/* vxlan flags */</span></div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="code" href="structvxlan__port__add__s.html#a7fbbe076345119b05d4822d047be833b">  117</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structvxlan__port__add__s.html#a7fbbe076345119b05d4822d047be833b">set_egress_orientation_using_vxlan_port_add</a>;  <span class="comment">/* egress orientation can be configured:</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">                                                       - using the api opennsl_vxlan_port_add,</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">                                                       when egress_tunnel_id (ip tunnel initiator gport, contains outlif) is valid (optional).</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">                                                       - using the api opennsl_port_class_set, update egress orientation.</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">                                                       By default: enabled */</span></div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="code" href="structvxlan__port__add__s.html#a3c72b692b025ba9c797e178e6df99ec1">  122</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structvxlan__port__add__s.html#a3c72b692b025ba9c797e178e6df99ec1">network_group_id</a>;         <span class="comment">/* forwarding group for vxlan port. Used for orientation filter */</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">/* If the FEC that is passed to vxlan port is an ECMP. We can&#39;t add directly the vxlan port to the</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">   * VSI flooding MC group.</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">   * We&#39;ll add instead the tunnel initiator interface to the VSI flooding MC group */</span></div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="code" href="structvxlan__port__add__s.html#a2130b5ecac56339ed90de17750ed590e">  127</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structvxlan__port__add__s.html#a2130b5ecac56339ed90de17750ed590e">is_ecmp</a>;                  <span class="comment">/* indicate that FEC that is passed to vxlan port is an ECMP */</span></div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="code" href="structvxlan__port__add__s.html#a02f4180359f2f3f4c8bfe223e6f96775">  128</a></span>&#160;  <a class="code" href="group__types.html#gaca0e18617c36271957788ac01ba44c2e" title="opennsl_if_t">opennsl_if_t</a> <a class="code" href="structvxlan__port__add__s.html#a02f4180359f2f3f4c8bfe223e6f96775">out_tunnel_if</a>;       <span class="comment">/* ip tunnel initiator itf */</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="comment">/* OUTPUT */</span></div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="code" href="structvxlan__port__add__s.html#a2d496e06482a0c065da46ceb7fe2f9c3">  131</a></span>&#160;  <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a> <a class="code" href="structvxlan__port__add__s.html#a2d496e06482a0c065da46ceb7fe2f9c3">vxlan_port_id</a>;    <span class="comment">/* returned vxlan gport */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;};</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">/* Creating L3 interface */</span></div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html">  136</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcreate__l3__intf__s.html">create_l3_intf_s</a> {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">/* Input */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#ade488a8984e2b1e8117977201ab85e34">  138</a></span>&#160;  <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structcreate__l3__intf__s.html#ade488a8984e2b1e8117977201ab85e34">flags</a>;                 <span class="comment">/* OPENNSL_L3_XXX */</span></div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#ab4d364f28625040a59d2082fad36c931">  139</a></span>&#160;  <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structcreate__l3__intf__s.html#ab4d364f28625040a59d2082fad36c931">ingress_flags</a>;         <span class="comment">/* OPENNSL_L3_INGRESS_XXX */</span></div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#ae9a43dcc685930edd966e3ba11482b4c">  140</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcreate__l3__intf__s.html#ae9a43dcc685930edd966e3ba11482b4c">no_publc</a>;                 <span class="comment">/* Used to force no public, public is forced if vrf = 0 or scale feature is turned on */</span></div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#a564aa639ea097d89c53b16761e2eff0b">  141</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcreate__l3__intf__s.html#a564aa639ea097d89c53b16761e2eff0b">vsi</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#ad17fcf4d0b6a92d48f8f5e1f3e514a10">  142</a></span>&#160;  <a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a> <a class="code" href="structcreate__l3__intf__s.html#ad17fcf4d0b6a92d48f8f5e1f3e514a10">my_global_mac</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#aa6d14a5e6193ff80e19ba88d4b7a4411">  143</a></span>&#160;  <a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a> <a class="code" href="structcreate__l3__intf__s.html#aa6d14a5e6193ff80e19ba88d4b7a4411">my_lsb_mac</a>;</div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#aa03ed0ffb6a161dd6384575910498bd8">  144</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcreate__l3__intf__s.html#aa03ed0ffb6a161dd6384575910498bd8">vrf_valid</a>;                <span class="comment">/* Do we need to set vrf */</span></div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#ab55b1b00e614e76e34c14a1c1c7ea722">  145</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcreate__l3__intf__s.html#ab55b1b00e614e76e34c14a1c1c7ea722">vrf</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#af3fe053b8eee484b7a2f6aad865f3c48">  146</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcreate__l3__intf__s.html#af3fe053b8eee484b7a2f6aad865f3c48">rpf_valid</a>;                <span class="comment">/* Do we need to set rpf */</span></div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#a60229d7110ab64661717d6661996ce31">  147</a></span>&#160;  <a class="code" href="group__l3.html#gad1547c994e10f0c6d8dc7b4fc1e3fb35" title="L3 Ingress Interface URPF Mode setting.">opennsl_l3_ingress_urpf_mode_t</a> <a class="code" href="structcreate__l3__intf__s.html#a60229d7110ab64661717d6661996ce31">urpf_mode</a>; <span class="comment">/* avail. when OPENNSL_L3_RPF is set */</span></div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#a6ab767b31e08f16ce24ee4f206498cd0">  148</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcreate__l3__intf__s.html#a6ab767b31e08f16ce24ee4f206498cd0">mtu_valid</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#ad003167e22301bc1bfa6cd0f8e015893">  149</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcreate__l3__intf__s.html#ad003167e22301bc1bfa6cd0f8e015893">mtu</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#aedf7a744442fd97a87649ffbe4daca7a">  150</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcreate__l3__intf__s.html#aedf7a744442fd97a87649ffbe4daca7a">mtu_forwarding</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#aaf66536a30054878e119d9acd06ec205">  151</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcreate__l3__intf__s.html#aaf66536a30054878e119d9acd06ec205">qos_map_valid</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#ad97ca83a2b0583f72ea9d2a2980184da">  152</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcreate__l3__intf__s.html#ad97ca83a2b0583f72ea9d2a2980184da">qos_map_id</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#ab7c506ae16ea0db13b6e90bb84b705ff">  153</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcreate__l3__intf__s.html#ab7c506ae16ea0db13b6e90bb84b705ff">ttl_valid</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#a3e799623c55add91dbaeb522fbcf90b8">  154</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcreate__l3__intf__s.html#a3e799623c55add91dbaeb522fbcf90b8">ttl</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#ab0b683220fb713d877f18bb91e195adb">  155</a></span>&#160;  <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structcreate__l3__intf__s.html#ab0b683220fb713d877f18bb91e195adb">native_routing_vlan_tags</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">/* Output */</span></div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#a28debc3d8a4a4faeca1205474eb44191">  158</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcreate__l3__intf__s.html#a28debc3d8a4a4faeca1205474eb44191">rif</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="code" href="structcreate__l3__intf__s.html#a9f87e9c3b45045e3138f0078a6338b10">  159</a></span>&#160;  <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structcreate__l3__intf__s.html#a9f87e9c3b45045e3138f0078a6338b10">skip_mymac</a>;             <span class="comment">/* If true, mymac will not be set. Make sure you set it elsewhere. */</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;};</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">/* Creating L3 egress */</span></div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="code" href="structcreate__l3__egress__s.html">  164</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcreate__l3__egress__s.html">create_l3_egress_s</a> {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">/* Input */</span></div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="code" href="structcreate__l3__egress__s.html#a0bfde0df8564a019553943094f9a2914">  166</a></span>&#160;  <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structcreate__l3__egress__s.html#a0bfde0df8564a019553943094f9a2914">allocation_flags</a>;      <span class="comment">/* OPENNSL_L3_XXX */</span></div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="code" href="structcreate__l3__egress__s.html#ab57fa5535985458434a0029c9a618042">  167</a></span>&#160;  <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structcreate__l3__egress__s.html#ab57fa5535985458434a0029c9a618042">l3_flags</a>;              <span class="comment">/* OPENNSL_L3_XXX */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="code" href="structcreate__l3__egress__s.html#aedf62eaf66e87fde30a48b47367f2095">  168</a></span>&#160;  <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structcreate__l3__egress__s.html#aedf62eaf66e87fde30a48b47367f2095">l3_flags2</a>;             <span class="comment">/* OPENNSL_L3_FLAGS2_XXX */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">/* ARP */</span></div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="code" href="structcreate__l3__egress__s.html#addaf76f3ca7163ad8983384027515713">  171</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcreate__l3__egress__s.html#addaf76f3ca7163ad8983384027515713">vlan</a>;                     <span class="comment">/* Outgoing vlan-VSI, relevant for ARP creation. In case set then SA MAC address is retreived from this VSI. */</span></div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="code" href="structcreate__l3__egress__s.html#a3b90370e27f84ad469f110c4e39eee14">  172</a></span>&#160;  <a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a> <a class="code" href="structcreate__l3__egress__s.html#a3b90370e27f84ad469f110c4e39eee14">next_hop_mac_addr</a>;  <span class="comment">/* Next-hop MAC address, relevant for ARP creation */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="code" href="structcreate__l3__egress__s.html#a174365355c2c9510d497ce22014b067f">  173</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcreate__l3__egress__s.html#a174365355c2c9510d497ce22014b067f">qos_map_id</a>;               <span class="comment">/* General QOS map id */</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">/* FEC */</span></div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="code" href="structcreate__l3__egress__s.html#ae7712a901c1185126fbc99ec1c3e05fb">  176</a></span>&#160;  <a class="code" href="group__types.html#gaca0e18617c36271957788ac01ba44c2e" title="opennsl_if_t">opennsl_if_t</a> <a class="code" href="structcreate__l3__egress__s.html#ae7712a901c1185126fbc99ec1c3e05fb">out_tunnel_or_rif</a>;   <span class="comment">/* *Outgoing intf, can be tunnel/rif, relevant for FEC creation */</span></div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="code" href="structcreate__l3__egress__s.html#ae2aae72d826c0aebbceeab27311787db">  177</a></span>&#160;  <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a> <a class="code" href="structcreate__l3__egress__s.html#ae2aae72d826c0aebbceeab27311787db">out_gport</a>;        <span class="comment">/* *Outgoing port , relevant for FEC creation */</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">/* Input/Output ID allocation */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="code" href="structcreate__l3__egress__s.html#a660e3c6d1170a31969e568b04dccbe7a">  180</a></span>&#160;  <a class="code" href="group__types.html#gaca0e18617c36271957788ac01ba44c2e" title="opennsl_if_t">opennsl_if_t</a> <a class="code" href="structcreate__l3__egress__s.html#a660e3c6d1170a31969e568b04dccbe7a">fec_id</a>;              <span class="comment">/* *FEC ID */</span></div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="code" href="structcreate__l3__egress__s.html#aa475f6c0813d25042d984bdd93eec535">  181</a></span>&#160;  <a class="code" href="group__types.html#gaca0e18617c36271957788ac01ba44c2e" title="opennsl_if_t">opennsl_if_t</a> <a class="code" href="structcreate__l3__egress__s.html#aa475f6c0813d25042d984bdd93eec535">arp_encap_id</a>;        <span class="comment">/* *ARP ID, may need for allocation ID or for FEC creation */</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;};</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="code" href="structvxlan__s.html">  185</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structvxlan__s.html">vxlan_s</a> {</div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="code" href="structvxlan__s.html#ad86bc71950683d29530ca040aaf545fe">  186</a></span>&#160;  <span class="keywordtype">int</span>          <a class="code" href="structvxlan__s.html#ad86bc71950683d29530ca040aaf545fe">vpn_id</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="code" href="structvxlan__s.html#abe6f1f9f9213a49e63de056544cb4191">  187</a></span>&#160;  <span class="keywordtype">int</span>          <a class="code" href="structvxlan__s.html#abe6f1f9f9213a49e63de056544cb4191">vni</a>;</div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="code" href="structvxlan__s.html#ae7d8ca029ccb27c998e23699eb540e5d">  188</a></span>&#160;  <span class="keywordtype">int</span>          <a class="code" href="structvxlan__s.html#ae7d8ca029ccb27c998e23699eb540e5d">vxlan_vdc_enable</a>;          <span class="comment">/* Option to enable/disable VXLAN VDC support */</span></div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="code" href="structvxlan__s.html#a9b5e69181be2bfb6c9dd27d2ceb6b01a">  189</a></span>&#160;  <span class="keywordtype">int</span>          <a class="code" href="structvxlan__s.html#a9b5e69181be2bfb6c9dd27d2ceb6b01a">vxlan_network_group_id</a>;    <span class="comment">/* ingress and egress orientation for VXLAN */</span></div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="code" href="structvxlan__s.html#ae31c573d0a4c39166a520e58375a7cd2">  190</a></span>&#160;  <span class="keywordtype">int</span>          <a class="code" href="structvxlan__s.html#ae31c573d0a4c39166a520e58375a7cd2">dip_sip_vrf_using_my_vtep_index_mode</a>; <span class="comment">/* configure DIP-&gt; my-vtep-index, tunnel term: my-vtep-index, SIP, VRF and</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">                                                        default tunnel term: DIP, SIP, VRF */</span></div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="code" href="structvxlan__s.html#a846e717770bb1041aaf65fd877c27c05">  192</a></span>&#160;  <span class="keywordtype">int</span>          <a class="code" href="structvxlan__s.html#a846e717770bb1041aaf65fd877c27c05">my_vtep_index</a>;             <span class="comment">/* used in dip_sip_vrf_using_my_vtep_index_mode */</span></div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="code" href="structvxlan__s.html#aed1548bcb4778c489fee321cb8070add">  193</a></span>&#160;  <span class="keywordtype">int</span>          <a class="code" href="structvxlan__s.html#aed1548bcb4778c489fee321cb8070add">access_port</a>;               <span class="comment">/* access port for the script */</span></div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="code" href="structvxlan__s.html#a920ac099de8959b39b8f02076afd837f">  194</a></span>&#160;  <span class="keywordtype">int</span>          <a class="code" href="structvxlan__s.html#a920ac099de8959b39b8f02076afd837f">network_port</a>;              <span class="comment">/* Network port for the script */</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">/* HW object created by the script */</span></div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="code" href="structvxlan__s.html#a7dde8b90deec0c176991dbff88289f35">  196</a></span>&#160;  <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a>  <a class="code" href="structvxlan__s.html#a7dde8b90deec0c176991dbff88289f35">tunnel_init_gport</a>;         <span class="comment">/* GPORT for Tunnel initiator */</span></div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="code" href="structvxlan__s.html#a5d21223d761c733751fa1f039ad77c63">  197</a></span>&#160;  <a class="code" href="group__types.html#gaca0e18617c36271957788ac01ba44c2e" title="opennsl_if_t">opennsl_if_t</a>     <a class="code" href="structvxlan__s.html#a5d21223d761c733751fa1f039ad77c63">tunnel_init_intf_id</a>;      <span class="comment">/* Tunnel interface Id for vxlan Tunnel */</span></div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="code" href="structvxlan__s.html#a8bb65f9081317e27044d587510e2fed7">  198</a></span>&#160;  <a class="code" href="group__types.html#gaca0e18617c36271957788ac01ba44c2e" title="opennsl_if_t">opennsl_if_t</a>     <a class="code" href="structvxlan__s.html#a8bb65f9081317e27044d587510e2fed7">vxlan_fec_intf_id</a>;         <span class="comment">/* fec for the VXLAN tunnel, set at example_vxlan */</span></div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="code" href="structvxlan__s.html#a1b647ccd563354898062549280703bb9">  199</a></span>&#160;  <span class="keywordtype">int</span>          <a class="code" href="structvxlan__s.html#a1b647ccd563354898062549280703bb9">mc_group_id</a>;               <span class="comment">/* Flood group created for VPN */</span></div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="code" href="structvxlan__s.html#a6d8b46cddca08debd4645f38e008dab5">  200</a></span>&#160;  <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a>  <a class="code" href="structvxlan__s.html#a6d8b46cddca08debd4645f38e008dab5">tunnel_term_gport</a>;         <span class="comment">/* GPORT for tunnel terminator */</span></div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="code" href="structvxlan__s.html#abb2535de38a9772d1086c307e988d1da">  201</a></span>&#160;  <a class="code" href="group__types.html#gaca0e18617c36271957788ac01ba44c2e" title="opennsl_if_t">opennsl_if_t</a>     <a class="code" href="structvxlan__s.html#abb2535de38a9772d1086c307e988d1da">prov_vlan_l3_intf_id</a>;      <span class="comment">/* L3 interface on provider vlan */</span></div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="code" href="structvxlan__s.html#a216de94dfb7c6b4dee49c39ac0d075d5">  202</a></span>&#160;  <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a>  <a class="code" href="structvxlan__s.html#a216de94dfb7c6b4dee49c39ac0d075d5">vlan_inLif</a>;                <span class="comment">/* InLif for the VLAN port on access port */</span></div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="code" href="structvxlan__s.html#ac0d9f56dd4557107733a1a6dcc480a0c">  203</a></span>&#160;  <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a>  <a class="code" href="structvxlan__s.html#ac0d9f56dd4557107733a1a6dcc480a0c">vxlan_gport</a>;               <span class="comment">/* GPORT for the VXLAN */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="code" href="structvxlan__s.html#a7248861a4911aa922e37411fb4df449a">  204</a></span>&#160;  <a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a>    <a class="code" href="structvxlan__s.html#a7248861a4911aa922e37411fb4df449a">user_mac_address</a>;          <span class="comment">/* UC static MAC address for inLif */</span></div>
<div class="line"><a name="l00205"></a><span class="lineno"><a class="code" href="structvxlan__s.html#ae0340b7e4b5b4b5026ab10c4aace77f4">  205</a></span>&#160;  <a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a>    <a class="code" href="structvxlan__s.html#ae0340b7e4b5b4b5026ab10c4aace77f4">tunnel_mac_address</a>;        <span class="comment">/* UC static MAC address for VxLAN */</span></div>
<div class="line"><a name="l00206"></a><span class="lineno"><a class="code" href="structvxlan__s.html#af238f93ae76db66e5d353eb48d21aa14">  206</a></span>&#160;  <a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a>    <a class="code" href="structvxlan__s.html#af238f93ae76db66e5d353eb48d21aa14">mc_mac</a>;                    <span class="comment">/* reserved MAC for MC traffic */</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;};</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a0bde41e626c41e89eb96aed08686c0bb">  210</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structvxlan__s.html">vxlan_s</a> <a class="code" href="dpp_2example__vxlan_8c.html#a0bde41e626c41e89eb96aed08686c0bb">g_vxlan</a> = {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  15,                 <span class="comment">/* vpn_id */</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  5000,               <span class="comment">/* vni    */</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  0,                  <span class="comment">/* enable vdc support */</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  1,                  <span class="comment">/* vxlan orientation */</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  0,                  <span class="comment">/* dip_sip_vrf_using_my_vtep_index_mode */</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  0x2,                <span class="comment">/* my_vtep_index */</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  0,                  <span class="comment">/* access port: Updated by script on execution */</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  0,                  <span class="comment">/* network port: Updated by script on execution */</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  0,0,0,0,0,0,0,0,    <span class="comment">/* Updatedd by script on execution */</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  { 0x00, 0x00, 0x00, 0x00, 0x00, 0xf0 },</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  { 0x00, 0x00, 0x00, 0x00, 0x00, 0xf1 },</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  { 0x01, 0x00, 0x5E, 0x01, 0x01, 0x14 }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;};</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a7df647d7b39028bae7fc129cbc272eb5">  226</a></span>&#160;<a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="dpp_2example__vxlan_8c.html#a7df647d7b39028bae7fc129cbc272eb5">vdc_port_class</a> = 10;</div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#aeaa487f5205c0aac9da4e004c173429c">  227</a></span>&#160;<span class="preprocessor">#define MY_MAC          {0x00, 0x0c, 0x00, 0x02, 0x00, 0x00}</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor"></span><span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="code" href="structip__tunnel__s.html">  230</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structip__tunnel__s.html">ip_tunnel_s</a> {</div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="code" href="structip__tunnel__s.html#aa93c11e74eaac66b07587afdcc3a615e">  231</a></span>&#160;  <a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a> <a class="code" href="structip__tunnel__s.html#aa93c11e74eaac66b07587afdcc3a615e">da</a>;                 <span class="comment">/* ip tunnel da */</span></div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="code" href="structip__tunnel__s.html#ae2419bff42cb7781a27946a896463127">  232</a></span>&#160;  <a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a> <a class="code" href="structip__tunnel__s.html#ae2419bff42cb7781a27946a896463127">sa</a>;                 <span class="comment">/* ip tunnel my mac */</span></div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="code" href="structip__tunnel__s.html#a7498174a2601cd591857b8679055671e">  233</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structip__tunnel__s.html#a7498174a2601cd591857b8679055671e">sip</a>;                      <span class="comment">/* ip tunnel sip */</span></div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="code" href="structip__tunnel__s.html#aa8f304a201c5f0e585cf0b24d7c68e30">  234</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structip__tunnel__s.html#aa8f304a201c5f0e585cf0b24d7c68e30">sip_mask</a>;</div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="code" href="structip__tunnel__s.html#a6e2cbabe1620866cc70d11725c36a9e0">  235</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structip__tunnel__s.html#a6e2cbabe1620866cc70d11725c36a9e0">dip</a>;                      <span class="comment">/* ip tunnel dip */</span></div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="code" href="structip__tunnel__s.html#ae7430678eeddcb4e49e24240fc5480cc">  236</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structip__tunnel__s.html#ae7430678eeddcb4e49e24240fc5480cc">dip_mask</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="code" href="structip__tunnel__s.html#ab4b8224cefab5f54172cb75e40434d85">  237</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structip__tunnel__s.html#ab4b8224cefab5f54172cb75e40434d85">ttl</a>;                      <span class="comment">/* ip tunnel ttl */</span></div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="code" href="structip__tunnel__s.html#a340e44021e9f43b5f40cd811a06b07d8">  238</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structip__tunnel__s.html#a340e44021e9f43b5f40cd811a06b07d8">dscp</a>;                     <span class="comment">/* ip tunnel dscp */</span></div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="code" href="structip__tunnel__s.html#a0ee0b2ddd7aa5a2014a81307792c7d15">  239</a></span>&#160;  <a class="code" href="group__tunnel.html#ga744c07b22929b49bf9b1258b68804b00" title="opennsl_tunnel_dscp_select_e">opennsl_tunnel_dscp_select_t</a> <a class="code" href="structip__tunnel__s.html#a0ee0b2ddd7aa5a2014a81307792c7d15">dscp_sel</a>;    <span class="comment">/* ip tunnel dscp_sel */</span></div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="code" href="structip__tunnel__s.html#aa1eb702ce743171c380383da4576f1e7">  240</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structip__tunnel__s.html#aa1eb702ce743171c380383da4576f1e7">flags</a>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;};</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"> * struct include meta information.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"> * where the cint logic pull data from this struct.</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"> * use to control differ runs of the cint, without changing the cint code</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00249"></a><span class="lineno"><a class="code" href="structip__tunnel__glbl__info__s.html">  249</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structip__tunnel__glbl__info__s.html">ip_tunnel_glbl_info_s</a> {</div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="code" href="structip__tunnel__glbl__info__s.html#ae369a39300829316147880f161f0a0ae">  250</a></span>&#160;  <a class="code" href="group__tunnel.html#gac30f3d86cc6b9c08b406825f94e729c8" title="Tunnel types.">opennsl_tunnel_type_t</a> <a class="code" href="structip__tunnel__glbl__info__s.html#ae369a39300829316147880f161f0a0ae">tunnel_type</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="code" href="structip__tunnel__glbl__info__s.html#adac12f83da3900c1e0f423c5e2a851f6">  251</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structip__tunnel__s.html">ip_tunnel_s</a> <a class="code" href="structip__tunnel__glbl__info__s.html#adac12f83da3900c1e0f423c5e2a851f6">ip_tunnel_info</a>;</div>
<div class="line"><a name="l00252"></a><span class="lineno"><a class="code" href="structip__tunnel__glbl__info__s.html#ac06eafb784664031824be6cdda096566">  252</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structip__tunnel__glbl__info__s.html#ac06eafb784664031824be6cdda096566">tunnel_vlan</a>;                     <span class="comment">/* vlan for ip tunnels */</span></div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="code" href="structip__tunnel__glbl__info__s.html#a64cd9f31c970420a8119bc9956c88da6">  253</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structip__tunnel__glbl__info__s.html#a64cd9f31c970420a8119bc9956c88da6">provider_vlan</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="code" href="structip__tunnel__glbl__info__s.html#a21b5a34ff96e8fe80f8068d3790871d6">  254</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structip__tunnel__glbl__info__s.html#a21b5a34ff96e8fe80f8068d3790871d6">access_vlan</a>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;};</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#ad2307df2ef1f52af04c1379716c8e940">  258</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structip__tunnel__glbl__info__s.html">ip_tunnel_glbl_info_s</a> <a class="code" href="dpp_2example__vxlan_8c.html#ad2307df2ef1f52af04c1379716c8e940">ip_tunnel_glbl_info</a> = {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="comment">/* tunnel type */</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <a class="code" href="group__tunnel.html#gga3e4190fb50ca1bcda4c884af45ca716fac1249e178f6daa961b5ae19195b4b1e1" title="VXLAN Tunnel.">opennslTunnelTypeVxlan</a>,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="comment">/* tunnel da                         |      sa               | sip: 170.0.0.17 | mask:0  */</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  {{0x20, 0x00, 0x00, 0x00, 0xcd, 0x1d}, <a class="code" href="dpp_2example__vxlan_8c.html#aeaa487f5205c0aac9da4e004c173429c">MY_MAC</a>, 0xAA000011,       0,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    0xAB000011, 0xFFFFFFFF,    50,    11,   <a class="code" href="group__tunnel.html#ggac3e728f0dd215de5da9911325eb139d0a0558ae670e8b16fef48c2c62a474b634" title="Copy packet DSCP to outer header.">opennslTunnelDscpPacket</a>, <a class="code" href="group__tunnel.html#ga453ccc063aa3d714687554ae1ed60c68" title="Copy DF from inner header.">OPENNSL_TUNNEL_INIT_USE_INNER_DF</a>},</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="comment">/* vlan for both ip tunnels */</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  20,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  20,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  200</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;};</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a152a7e2d2abdc2542fd24cb3cd10f25d" title="Create ipv4 tunnel.">example_ip_tunnel_add</a>(<span class="keywordtype">int</span> unit, <a class="code" href="group__types.html#gaca0e18617c36271957788ac01ba44c2e" title="opennsl_if_t">opennsl_if_t</a> *itf,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="structopennsl__tunnel__initiator__s.html" title="L3 tunneling initiator.">opennsl_tunnel_initiator_t</a> * <a class="code" href="opennsl__api_8dox.html#aa5eb3d2bb92909819359b4fd24749880">tunnel</a>);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">/* Utility API */</span></div>
<div class="line"><a name="l00275"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">  275</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[100] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00284"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a250f8b62242774ce141a27acb9752aaa">  284</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="dpp_2example__vxlan_8c.html#a250f8b62242774ce141a27acb9752aaa" title="OTP portmap for DNX device.">init_portmap</a>(<span class="keywordtype">int</span> unit)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;{</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="structopennsl__info__s.html" title="OPENNSL Information structure.">opennsl_info_t</a> info;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordtype">int</span> rv = <a class="code" href="group__init.html#ga64691ef7b923460206cd9abb675807c0" title="Get information about a OPENNSL unit.">opennsl_info_get</a>(unit, &amp;info);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    printf(<span class="stringliteral">&quot;Error in getting the chip info, Error = %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="examples_2util_8h.html#a131ca7039d41fc26c375479724d2f903" title="Returns true if the device is Qumran-MX device.">example_is_qmx_device</a>(unit))</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[1]=13;  <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[2]=14;  <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[3]=15;  <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[4]=16;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[5]=17;  <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[6]=18;  <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[7]=19;  <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[8]=20;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[9]=21;  <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[10]=22; <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[11]=23; <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[12]=24;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[13]=25; <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[14]=26; <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[15]=27; <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[16]=28;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[17]=29; <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[18]=30; <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[19]=31; <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[20]=32;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    printf(<span class="stringliteral">&quot;device is not QMX\n&quot;</span>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">for</span> (i=1;i&lt;50;i++)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[i]=i;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;}</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00320"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a687c7c8830a4913646170e0fb626abc4">  320</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="dpp_2example__vxlan_8c.html#a687c7c8830a4913646170e0fb626abc4" title="Utility function to print IP tunnel parameters.">example_ip_tunnel_term_print_key</a>(<span class="keywordtype">char</span> *type,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="structopennsl__tunnel__terminator__s.html" title="L3 tunneling terminator.">opennsl_tunnel_terminator_t</a> *tunnel_term)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;{</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  printf(<span class="stringliteral">&quot;%s  key: &quot;</span>, type);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">if</span> (tunnel_term-&gt;<a class="code" href="structopennsl__tunnel__terminator__s.html#abbe9c0b5556f85bdff0962b3e6c5cd1d" title="Source IP mask.">sip_mask</a> == 0) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    printf(<span class="stringliteral">&quot;SIP: masked    &quot;</span>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tunnel_term-&gt;<a class="code" href="structopennsl__tunnel__terminator__s.html#abbe9c0b5556f85bdff0962b3e6c5cd1d" title="Source IP mask.">sip_mask</a> == 0xFFFFFFFF) {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="examples_2util_8h.html#a8af6968664b72ffda55645d67cb908be" title="To print IP address in dotted decimal format.">print_ip_addr</a>(<span class="stringliteral">&quot;SIP:&quot;</span>, tunnel_term-&gt;<a class="code" href="structopennsl__tunnel__terminator__s.html#a5cbcb1eaa0a16ebc96c576dfc73421b5" title="SIP for tunnel header match.">sip</a>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    printf(<span class="stringliteral">&quot;/0x%08x &quot;</span>, tunnel_term-&gt;<a class="code" href="structopennsl__tunnel__terminator__s.html#abbe9c0b5556f85bdff0962b3e6c5cd1d" title="Source IP mask.">sip_mask</a>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">if</span> (tunnel_term-&gt;<a class="code" href="structopennsl__tunnel__terminator__s.html#acf11a94221a666cd7581ca3404528ded" title="Destination IP mask.">dip_mask</a> == 0) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    printf(<span class="stringliteral">&quot;DIP: masked    &quot;</span>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tunnel_term-&gt;<a class="code" href="structopennsl__tunnel__terminator__s.html#acf11a94221a666cd7581ca3404528ded" title="Destination IP mask.">dip_mask</a> == 0xFFFFFFFF) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="examples_2util_8h.html#a8af6968664b72ffda55645d67cb908be" title="To print IP address in dotted decimal format.">print_ip_addr</a>(<span class="stringliteral">&quot;DIP:&quot;</span>, tunnel_term-&gt;<a class="code" href="structopennsl__tunnel__terminator__s.html#a57a7d057bf79bbcfed4db60fd9236b7e" title="DIP for tunnel header match.">dip</a>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    printf(<span class="stringliteral">&quot;/0x%08x &quot;</span>, tunnel_term-&gt;<a class="code" href="structopennsl__tunnel__terminator__s.html#acf11a94221a666cd7581ca3404528ded" title="Destination IP mask.">dip_mask</a>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  printf(<span class="stringliteral">&quot;RIF: 0x%08x &quot;</span>, tunnel_term-&gt;<a class="code" href="structopennsl__tunnel__terminator__s.html#aa598195e2194e7add6b28b39d0d62b10" title="hierarchical interface.">tunnel_if</a>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  printf(<span class="stringliteral">&quot;\n\r&quot;</span>);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"> * add entry to mac table &lt;vlan,mac&gt; --&gt; port</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"> * &lt;VID, MAC&gt; --&gt; port</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00359"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a6ff8a48e7bde727289c04b10bcea2197">  359</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a6ff8a48e7bde727289c04b10bcea2197" title="To update MAC table.">example_l2_addr_add</a>(<span class="keywordtype">int</span> unit, <a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a> mac,</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> vid, <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a> <a class="code" href="opennsl__api_8dox.html#abd1fe5382f13606db566da3450b351b0">port</a>)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;{</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordtype">int</span> rv;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <a class="code" href="structopennsl__l2__addr__s.html" title="Device-independent L2 address structure.">opennsl_l2_addr_t</a> l2addr;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <a class="code" href="group__l2.html#ga47e819cf5939a8e643ad09505df52071" title="Initialize an L2 address structure to a specified MAC address and VLAN ID.">opennsl_l2_addr_t_init</a>(&amp;l2addr, mac, vid);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  l2addr.<a class="code" href="structopennsl__l2__addr__s.html#a7546884120ba8ab5dce9348fd9bd819f" title="Zero-based port number.">port</a> = <a class="code" href="opennsl__api_8dox.html#abd1fe5382f13606db566da3450b351b0">port</a>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  l2addr.<a class="code" href="structopennsl__l2__addr__s.html#a4a220dea5708ef83208923402a402cb1" title="VLAN identifier.">vid</a> = vid;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  l2addr.<a class="code" href="structopennsl__l2__addr__s.html#a3c915015c746bbad9799b9a40a51b829" title="OPENNSL_L2_xxx flags.">flags</a> = <a class="code" href="group__l2.html#ga838d2e1cee40e3ae41cd4a59599dd333">OPENNSL_L2_STATIC</a>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  rv = <a class="code" href="group__l2.html#ga4b8920c1c3cf4c0c59bf8f0c5890f7c5" title="Add an L2 address entry to the specified device.">opennsl_l2_addr_add</a>(unit, &amp;l2addr);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    printf(<span class="stringliteral">&quot;Error, Failed to add L2 entry, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt; 2) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    printf(<span class="stringliteral">&quot;l2 entry: fid = %d &quot;</span>, vid);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="examples_2util_8h.html#a3262fde70495cd6e0f3afd6baf9ae95c" title="To print the MAC address.">l2_print_mac</a>(<span class="stringliteral">&quot;mac =&quot;</span>, mac);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    printf(<span class="stringliteral">&quot;  dest-port 0x%08x \n&quot;</span>, port);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;}</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a7a5576d260494b0638d376d16223de74">  401</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a7a5576d260494b0638d376d16223de74" title="Adding entries to MC group.">example_add_multicast_entry</a>(<span class="keywordtype">int</span> unit, <span class="keywordtype">int</span> ipmc_index,</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordtype">int</span> *<a class="code" href="opennsl__api_8dox.html#af9d2702e21ab86e9074894ba172b114d">ports</a>, <span class="keywordtype">int</span> *cud, <span class="keywordtype">int</span> nof_mc_entries, <span class="keywordtype">int</span> is_egress)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;{</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordtype">int</span> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; nof_mc_entries; i++) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">/* egress MC */</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">if</span> (is_egress) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      rv = <a class="code" href="group__multicast.html#gae60ad27650b6302a5fc73df3af8efaa6" title="Add an encapsulated interface to a multicast group&#39;s replication list on a specific port...">opennsl_multicast_egress_add</a>(unit, ipmc_index, ports[i], cud[i]);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        printf(<span class="stringliteral">&quot;Failed to add egress multicast entry, port %d encap_id: %d, Error %s\n&quot;</span>, ports[i],</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            cud[i], <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">/* ingress MC */</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      rv = <a class="code" href="group__multicast.html#gafa55f761fe7a9b6026267234c3fd7057" title="Add a port to a Ingress Multicast group&#39;s replication list.">opennsl_multicast_ingress_add</a>(unit, ipmc_index, ports[i], cud[i]);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        printf(<span class="stringliteral">&quot;Error, opennsl_multicast_ingress_add: port %d encap_id: %d \n&quot;</span>,</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            ports[i], cud[i]);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;}</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00443"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a3e963257e80f70696214f007b5a77a6a">  443</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a3e963257e80f70696214f007b5a77a6a" title="Add gport of type vlan-port to the multicast.">example_vlan_port_add</a>( <span class="keywordtype">int</span> unit, <span class="keywordtype">int</span> mc_group_id,</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordtype">int</span> sys_port, <span class="keywordtype">int</span> gport, <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> is_egress)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;{</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordtype">int</span> encap_id;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordtype">int</span> rv;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  rv = <a class="code" href="group__multicast.html#ga64838f4544fab1f6afb798f0ce993c07" title="Get the multicast encapsulation ID for layer 2 logical port replication.">opennsl_multicast_vlan_encap_get</a>(unit, mc_group_id, sys_port, gport, &amp;encap_id);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    printf(<span class="stringliteral">&quot;Failed to get multicast encapsulation ID for Multicast group 0x%08x&quot;</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="stringliteral">&quot; phy_port: 0x%08x  gport: 0x%08x, Error %s\n&quot;</span>,</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        mc_group_id, sys_port, gport, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#a7a5576d260494b0638d376d16223de74" title="Adding entries to MC group.">example_add_multicast_entry</a>(unit, mc_group_id, &amp;sys_port,</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      &amp;encap_id, 1, is_egress);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    printf(<span class="stringliteral">&quot;Failed to add multicast entry for mc_group_id: 0x%08x &quot;</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="stringliteral">&quot;phy_port: 0x%08x gport: 0x%08x, Error %s \n&quot;</span>,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        mc_group_id, sys_port, gport, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;}</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00480"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a420d8c462502c6c006b9382625dc1048">  480</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a420d8c462502c6c006b9382625dc1048" title="Add gport of type vlan-port to the multicast.">example_add_inLif_to_vswitch</a>(<span class="keywordtype">int</span> unit, <a class="code" href="group__types.html#gaff94709d1708a51eb9aadb2e9fa03875" title="opennsl_vlan_t">opennsl_vlan_t</a> vsi,</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="group__types.html#gacaeba2b4ddbc89b0e556720a9388885f" title="Set the default tag protocol ID (TPID) for the specified port.">opennsl_port_t</a> phy_port, <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a> gport)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;{</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordtype">int</span> rv;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="comment">/* add to vswitch */</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  rv = <a class="code" href="group__vswitch.html#ga1951ac6adec6a4a558009cd785708772" title="Add a logical port to the specified virtual switching instance.">opennsl_vswitch_port_add</a>(unit, vsi, gport);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    printf(<span class="stringliteral">&quot;Failed to add a port to vswitch, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a>) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    printf(<span class="stringliteral">&quot;add access port 0x%08x to vswitch %d (0x%08x) \n\r&quot;</span>, gport, vsi, vsi);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">/* update Multicast to have the added port  */</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#a3e963257e80f70696214f007b5a77a6a" title="Add gport of type vlan-port to the multicast.">example_vlan_port_add</a>(unit, g_vxlan.<a class="code" href="structvxlan__s.html#a1b647ccd563354898062549280703bb9">mc_group_id</a>, phy_port, gport, 0);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    printf(<span class="stringliteral">&quot;Failed to add a port to multicast group, phy_port: 0x%08x &quot;</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="stringliteral">&quot;gport: 0x%08x, Error %s\n&quot;</span>, phy_port, gport, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a>) {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    printf(<span class="stringliteral">&quot;add access port 0x%08x to multicast in unit %d\n&quot;</span>, gport, unit);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;}</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00519"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a059dcd96d8f3c160df3b353ebc06cc56">  519</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a059dcd96d8f3c160df3b353ebc06cc56" title="Remove gport of type vlan-port from the multicast group.">remove_inLif_from_vswitch</a>(<span class="keywordtype">int</span> unit, <a class="code" href="group__types.html#gaff94709d1708a51eb9aadb2e9fa03875" title="opennsl_vlan_t">opennsl_vlan_t</a>  vsi,</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="group__types.html#gacaeba2b4ddbc89b0e556720a9388885f" title="Set the default tag protocol ID (TPID) for the specified port.">opennsl_port_t</a>  phy_port, <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a> vlan_port)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;{</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordtype">int</span> rv;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordtype">int</span> encap_id;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  rv = <a class="code" href="group__multicast.html#ga64838f4544fab1f6afb798f0ce993c07" title="Get the multicast encapsulation ID for layer 2 logical port replication.">opennsl_multicast_vlan_encap_get</a>(unit, g_vxlan.<a class="code" href="structvxlan__s.html#a1b647ccd563354898062549280703bb9">mc_group_id</a>, phy_port, vlan_port, &amp;encap_id);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    printf(<span class="stringliteral">&quot;Failed to get encapsulation ID for mc_group_id: 0x%08x &quot;</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="stringliteral">&quot;phy_port: 0x%08x vlan_port: 0x%08x, Error %s \n&quot;</span>,</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        g_vxlan.<a class="code" href="structvxlan__s.html#a1b647ccd563354898062549280703bb9">mc_group_id</a>, phy_port, vlan_port, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  rv = <a class="code" href="group__multicast.html#gae92827d7cece3e754a4886ba15e3c5b4" title="Delete a port from Ingress Multicast group&#39;s replication list.">opennsl_multicast_ingress_delete</a>(unit, g_vxlan.<a class="code" href="structvxlan__s.html#a1b647ccd563354898062549280703bb9">mc_group_id</a>, phy_port, encap_id);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">if</span> (rv == <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a90445f03d34051de0c90acfd955ef178">OPENNSL_E_NOT_FOUND</a>) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    printf(<span class="stringliteral">&quot;Failed to delete phy_port: 0x%08x from multicast group ID %d, Error %s\n&quot;</span>,</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        phy_port, g_vxlan.<a class="code" href="structvxlan__s.html#a1b647ccd563354898062549280703bb9">mc_group_id</a>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  printf (<span class="stringliteral">&quot;Deleted phy_port: 0x%08x, encap_id:0x%08x from multicast group with ID: 0x%08x\n&quot;</span>,</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      phy_port, encap_id, g_vxlan.<a class="code" href="structvxlan__s.html#a1b647ccd563354898062549280703bb9">mc_group_id</a>);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="comment">/* remove from vswitch */</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  rv = <a class="code" href="group__vswitch.html#ga4213b61720ac1ddd547a958f2a557a66" title="Remove a logical port from the specified virtual switching instance.">opennsl_vswitch_port_delete</a>(unit, vsi, vlan_port);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    printf(<span class="stringliteral">&quot;Failed to remove port 0x%08x from vsi 0x%08x, Error %s\n&quot;</span>,</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        vlan_port, vsi, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a>) {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    printf(<span class="stringliteral">&quot;Removed port 0x%08x from vswitch 0x%08x\n\r&quot;</span>, vlan_port, vsi);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;}</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00567"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a335e19d71758c4b885c99c86a0cb3ea2">  567</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a335e19d71758c4b885c99c86a0cb3ea2" title="Create new VSI.">example_open_vlan_per_mc</a>(</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordtype">int</span> unit, <span class="keywordtype">int</span> vlan, <a class="code" href="group__types.html#ga50bad717e3851cb2dd6acaac4d2a2f1b" title="opennsl_multicast_t">opennsl_multicast_t</a> mc_group)</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;{</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordtype">int</span> rv;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="comment">/* The vlan in this case may also represent a vsi. in that case, it should be created with a different api */</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keywordflow">if</span> (vlan &lt;= <a class="code" href="group__types.html#ga872ed872034a93a888718d259d21c615">OPENNSL_VLAN_MAX</a>) {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    rv = <a class="code" href="group__vlan.html#ga4db9e633ba9c276064768d1718c3062c" title="Allocate and configure a VLAN on the OPENNSL device.">opennsl_vlan_create</a>(unit, vlan);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    rv = <a class="code" href="group__vswitch.html#ga7fa63a56dcff35bd6001da0a18727e68" title="Create a Virtual Switching Instance, with a specified ID.">opennsl_vswitch_create_with_id</a>(unit, vlan);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordflow">if</span> ((rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) &amp;&amp; (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5ad03e135eecd46c9c1280e7b3f6ab5b6a">OPENNSL_E_EXISTS</a>)) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    printf(<span class="stringliteral">&quot;Failed to opensl vlan(%d), Error %s&quot;</span>, vlan, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="comment">/* Set VLAN with MC is not required for VXLAN, removed below calls */</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 3) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    printf(<span class="stringliteral">&quot;Created vlan:%d \n&quot;</span>, vlan);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;}</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00601"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#af5e2420d40444ad4494bf9b63c51d07c">  601</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="dpp_2example__vxlan_8c.html#af5e2420d40444ad4494bf9b63c51d07c" title="Open new vsi and attach it to the give mc_group.">example_add_vlan_on_port</a>(</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordtype">int</span> unit,</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordtype">int</span> vlan,</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="opennsl__api_8dox.html#abd1fe5382f13606db566da3450b351b0">port</a>)</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;{</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordtype">int</span> rv;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="comment">/* create vlan and add port to it */</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#a335e19d71758c4b885c99c86a0cb3ea2" title="Create new VSI.">example_open_vlan_per_mc</a>(unit, vlan, 0);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  rv = <a class="code" href="group__vlan.html#ga56e2dc3c7cf8dd9dd7985c4980393645" title="Add a virtual or physical port to the specified VLAN.">opennsl_vlan_gport_add</a>(unit, vlan, port, 0);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordflow">if</span> ((rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) &amp;&amp; (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5ad03e135eecd46c9c1280e7b3f6ab5b6a">OPENNSL_E_EXISTS</a>)) {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    printf(<span class="stringliteral">&quot;Failed to add port(0x%08x) to vlan %d, Error %s\n&quot;</span>,</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        port, vlan, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  printf(<span class="stringliteral">&quot;Added port %d (0x%08x) to vlan %d\n&quot;</span>, port, port, vlan);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;}</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00631"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#ad74eca815fd91ca5fda606965f3468c5">  631</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="dpp_2example__vxlan_8c.html#ad74eca815fd91ca5fda606965f3468c5" title="Utility function to add ports to relevant VLAN&#39;s.">example_add_ports_to_vlans</a>(</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordtype">int</span> unit, <span class="keywordtype">int</span> network_port, <span class="keywordtype">int</span> access_port)</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;{</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="comment">/*** create tunnel_vlan and add the network port  ***/</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="keywordflow">if</span> (ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#ac06eafb784664031824be6cdda096566">tunnel_vlan</a> != ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#a64cd9f31c970420a8119bc9956c88da6">provider_vlan</a>) </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <a class="code" href="dpp_2example__vxlan_8c.html#af5e2420d40444ad4494bf9b63c51d07c" title="Open new vsi and attach it to the give mc_group.">example_add_vlan_on_port</a>(unit, ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#ac06eafb784664031824be6cdda096566">tunnel_vlan</a>, network_port);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">/*** create provider_vlan and add network port to it ***/</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <a class="code" href="dpp_2example__vxlan_8c.html#af5e2420d40444ad4494bf9b63c51d07c" title="Open new vsi and attach it to the give mc_group.">example_add_vlan_on_port</a>(unit, ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#a64cd9f31c970420a8119bc9956c88da6">provider_vlan</a>, network_port);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="comment">/*** create access_vlan and add user port to it ***/</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <a class="code" href="dpp_2example__vxlan_8c.html#af5e2420d40444ad4494bf9b63c51d07c" title="Open new vsi and attach it to the give mc_group.">example_add_vlan_on_port</a>(unit, ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#a21b5a34ff96e8fe80f8068d3790871d6">access_vlan</a>, access_port);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;}</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00657"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#ac7704d686c6c44bb0da37824d699966d">  657</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#ac7704d686c6c44bb0da37824d699966d" title="Utility function to create multicast group.">example_multicast_group_open</a>(</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordtype">int</span> unit, <span class="keywordtype">int</span> *mc_group_id, <span class="keywordtype">int</span> extra_flags)</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;{</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="keywordtype">int</span> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordtype">int</span> flags;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  flags = <a class="code" href="group__multicast.html#gaf2991b6d0bfbd56d66953868e6c099be">OPENNSL_MULTICAST_WITH_ID</a> | extra_flags;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="comment">/* create ingress/egress MC */</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="example__cos_8c.html#a8b5659941298c6f209a80a5bb61b6bf7">egress_mc</a>) {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    flags |= <a class="code" href="group__multicast.html#ga9d5471deb377bb1324e0b77f04319250">OPENNSL_MULTICAST_EGRESS_GROUP</a>;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    flags |= <a class="code" href="group__multicast.html#gaae730f6ddddbdef6db10444bc9e5a657">OPENNSL_MULTICAST_INGRESS_GROUP</a>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  rv = <a class="code" href="group__multicast.html#ga9134d19d090cf0b13f883abc1edf606c" title="Create a multicast group for packet replication.">opennsl_multicast_create</a>(unit, flags, mc_group_id);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    printf(<span class="stringliteral">&quot;Failed to create multicast group with ID %d, Error %s\n&quot;</span>,</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        *mc_group_id, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="example__cos_8c.html#a8b5659941298c6f209a80a5bb61b6bf7">egress_mc</a>) {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    printf(<span class="stringliteral">&quot;Created egress mc_group %d (0x%x) \n&quot;</span>, *mc_group_id, *mc_group_id);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    printf(<span class="stringliteral">&quot;Created ingress mc_group %d (0x%x) \n&quot;</span>, *mc_group_id, *mc_group_id);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="comment">/* save multicast group id */</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  g_vxlan.<a class="code" href="structvxlan__s.html#a1b647ccd563354898062549280703bb9">mc_group_id</a> = *mc_group_id;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;}</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00698"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a4e714391e0198579d1509fd5231af009">  698</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a4e714391e0198579d1509fd5231af009" title="Create L3 egress object for FEC and ARP entry.">example_l3_egress_create</a>(<span class="keywordtype">int</span> unit, <span class="keyword">struct</span> <a class="code" href="structcreate__l3__egress__s.html">create_l3_egress_s</a> *l3_egress)</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;{</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordtype">int</span> rv;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <a class="code" href="structopennsl__l3__egress__s.html" title="L3 Egress Structure.">opennsl_l3_egress_t</a> l3eg;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <a class="code" href="group__types.html#gaca0e18617c36271957788ac01ba44c2e" title="opennsl_if_t">opennsl_if_t</a> l3egid;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <a class="code" href="group__l3.html#ga10b5ea766149d2bfdcd9d453939057e5" title="Initialize a opennsl_l3_egress_t structure.">opennsl_l3_egress_t_init</a>(&amp;l3eg);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="comment">/* FEC properties */</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  l3eg.<a class="code" href="structopennsl__l3__egress__s.html#a495387f57bb66a0b0c38842564af10ec" title="L3 interface (source MAC, tunnel).">intf</a> = l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#ae7712a901c1185126fbc99ec1c3e05fb">out_tunnel_or_rif</a>;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  l3eg.<a class="code" href="structopennsl__l3__egress__s.html#af53aa7695462aa231d4ba889ad06601a" title="Port packet switched to (if !OPENNSL_L3_TGID).">port</a> = l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#ae2aae72d826c0aebbceeab27311787db">out_gport</a>;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  l3eg.<a class="code" href="structopennsl__l3__egress__s.html#aa2d4d9b638d36c0ead585e6c9e103f46" title="Encapsulation index.">encap_id</a> = l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#aa475f6c0813d25042d984bdd93eec535">arp_encap_id</a>;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="comment">/* ARP */</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  memcpy(&amp;l3eg.<a class="code" href="structopennsl__l3__egress__s.html#a414a0355e3fd86ac89a7f061810f4ce6" title="Next hop forwarding destination mac.">mac_addr</a>, &amp;l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#a3b90370e27f84ad469f110c4e39eee14">next_hop_mac_addr</a>, <span class="keyword">sizeof</span>(<a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a>));</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  l3eg.<a class="code" href="structopennsl__l3__egress__s.html#a4559c3254ee6ba88106523dd8c9b4422" title="Next hop vlan id.">vlan</a> = l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#addaf76f3ca7163ad8983384027515713">vlan</a>;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  l3eg.<a class="code" href="structopennsl__l3__egress__s.html#ac93e3e7889729bce6e37a77b6a2bc270" title="General QOS map id.">qos_map_id</a> = l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#a174365355c2c9510d497ce22014b067f">qos_map_id</a>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  l3eg.<a class="code" href="structopennsl__l3__egress__s.html#ad2020d0ca398d03556c939201f5d1744" title="Interface flags (OPENNSL_L3_TGID, OPENNSL_L3_L2TOCPU).">flags</a> = l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#ab57fa5535985458434a0029c9a618042">l3_flags</a>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  l3eg.<a class="code" href="structopennsl__l3__egress__s.html#a760fcbbce602d71818278740a1ad7709" title="See OPENNSL_L3_FLAGS2_xxx flag definitions.">flags2</a> = l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#aedf62eaf66e87fde30a48b47367f2095">l3_flags2</a>;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  l3egid = l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#a660e3c6d1170a31969e568b04dccbe7a">fec_id</a>;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  rv = <a class="code" href="group__l3.html#ga0b4c7fdba7b362a408ba712e6894ee50" title="Create an Egress forwarding object.">opennsl_l3_egress_create</a>(unit, l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#a0bfde0df8564a019553943094f9a2914">allocation_flags</a>, &amp;l3eg, &amp;l3egid);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    printf(<span class="stringliteral">&quot;Failed to create egress egress object, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  }</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#a660e3c6d1170a31969e568b04dccbe7a">fec_id</a> = l3egid;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#aa475f6c0813d25042d984bdd93eec535">arp_encap_id</a> = l3eg.<a class="code" href="structopennsl__l3__egress__s.html#aa2d4d9b638d36c0ead585e6c9e103f46" title="Encapsulation index.">encap_id</a>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 1) {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    printf(<span class="stringliteral">&quot;VLAN:%d created FEC-id = 0x%08x, &quot;</span>, l3eg.<a class="code" href="structopennsl__l3__egress__s.html#a4559c3254ee6ba88106523dd8c9b4422" title="Next hop vlan id.">vlan</a>,</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#a660e3c6d1170a31969e568b04dccbe7a">fec_id</a>);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    printf(<span class="stringliteral">&quot;encap-id = 0x%08x &quot;</span>, l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#aa475f6c0813d25042d984bdd93eec535">arp_encap_id</a>);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 2) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    printf(<span class="stringliteral">&quot;\n\toutRIF = 0x%08x out-port =%d &quot;</span>, l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#ae7712a901c1185126fbc99ec1c3e05fb">out_tunnel_or_rif</a>,</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        l3_egress-&gt;<a class="code" href="structcreate__l3__egress__s.html#ae2aae72d826c0aebbceeab27311787db">out_gport</a>);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    printf(<span class="stringliteral">&quot;mac-address: %02x:%02x:%02x:%02x:%02x:%02x&quot;</span>,</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        l3eg.<a class="code" href="structopennsl__l3__egress__s.html#a414a0355e3fd86ac89a7f061810f4ce6" title="Next hop forwarding destination mac.">mac_addr</a>[0], l3eg.<a class="code" href="structopennsl__l3__egress__s.html#a414a0355e3fd86ac89a7f061810f4ce6" title="Next hop forwarding destination mac.">mac_addr</a>[1], l3eg.<a class="code" href="structopennsl__l3__egress__s.html#a414a0355e3fd86ac89a7f061810f4ce6" title="Next hop forwarding destination mac.">mac_addr</a>[2],</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        l3eg.<a class="code" href="structopennsl__l3__egress__s.html#a414a0355e3fd86ac89a7f061810f4ce6" title="Next hop forwarding destination mac.">mac_addr</a>[3], l3eg.<a class="code" href="structopennsl__l3__egress__s.html#a414a0355e3fd86ac89a7f061810f4ce6" title="Next hop forwarding destination mac.">mac_addr</a>[4], l3eg.<a class="code" href="structopennsl__l3__egress__s.html#a414a0355e3fd86ac89a7f061810f4ce6" title="Next hop forwarding destination mac.">mac_addr</a>[5]);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 1) {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;}</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00768"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a3a4da3d88b48f189c51ee4f03da1b112">  768</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a3a4da3d88b48f189c51ee4f03da1b112" title="Create Router interface.">example_l3_intf_rif_create</a>(</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordtype">int</span> unit, <span class="keyword">struct</span> <a class="code" href="structcreate__l3__intf__s.html">create_l3_intf_s</a> * l3_intf)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;{</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <a class="code" href="structopennsl__l3__intf__s.html" title="L3 Interface Structure.">opennsl_l3_intf_t</a> l3if, l3if_old;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="keywordtype">int</span> rv, station_id;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <a class="code" href="structopennsl__l2__station__s.html" title="L2 Station address info.">opennsl_l2_station_t</a> station;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <a class="code" href="structopennsl__l3__ingress__s.html" title="L3 Ingress Structure.">opennsl_l3_ingress_t</a> l3_ing_if;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="keywordtype">int</span> is_urpf_mode_per_rif = 0;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keywordtype">int</span> enable_public = 0;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="comment">/* Initialize a opennsl_l3_intf_t structure. */</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <a class="code" href="group__l3.html#gaa92edab97138caed29fe11f4f9b35fa7" title="Initialize a opennsl_l3_intf_t structure.">opennsl_l3_intf_t_init</a>(&amp;l3if);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <a class="code" href="group__l3.html#gaa92edab97138caed29fe11f4f9b35fa7" title="Initialize a opennsl_l3_intf_t structure.">opennsl_l3_intf_t_init</a>(&amp;l3if_old);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <a class="code" href="group__l2.html#ga237f10dccfaf6f29a0c4ccee74a3ed8e" title="Initialize L2 Station structure.">opennsl_l2_station_t_init</a>(&amp;station);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <a class="code" href="group__l3.html#ga326fd6c3b1e90668a46fe57d4fa5d482" title="Initialize L3 Ingress Interface object structure.">opennsl_l3_ingress_t_init</a>(&amp;l3_ing_if);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="keywordflow">if</span> (!l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#a9f87e9c3b45045e3138f0078a6338b10">skip_mymac</a>) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="comment">/* set my-Mac global MSB */</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    station.<a class="code" href="structopennsl__l2__station__s.html#a2eb42681485db17c250d2aab2481403d" title="OPENNSL_L2_STATION_xxx flags.">flags</a> = 0;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    memcpy(station.<a class="code" href="structopennsl__l2__station__s.html#ac294283242a88ad175d25e02f621d5f5" title="Destination MAC address to match.">dst_mac</a>, l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ad17fcf4d0b6a92d48f8f5e1f3e514a10">my_global_mac</a>, <span class="keyword">sizeof</span>(<a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a>));</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    station.<a class="code" href="structopennsl__l2__station__s.html#ad84dded12ef92f9ef708d7ba5ac5dee2" title="Ingress port mask value.">src_port_mask</a> = 0;  <span class="comment">/* port is not valid */</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    station.<a class="code" href="structopennsl__l2__station__s.html#a42011f54c5fd03cd3c6bf292b14e9af5" title="VLAN mask value.">vlan_mask</a> = 0;      <span class="comment">/* vsi is not valid */</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    station.<a class="code" href="structopennsl__l2__station__s.html#ace249a6805ad70b11bef4ee29358d93b" title="Destination MAC address mask value.">dst_mac_mask</a>[0] = 0xff; <span class="comment">/* dst_mac my-Mac MSB mask is -1 */</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    station.<a class="code" href="structopennsl__l2__station__s.html#ace249a6805ad70b11bef4ee29358d93b" title="Destination MAC address mask value.">dst_mac_mask</a>[1] = 0xff;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    station.<a class="code" href="structopennsl__l2__station__s.html#ace249a6805ad70b11bef4ee29358d93b" title="Destination MAC address mask value.">dst_mac_mask</a>[2] = 0xff;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    station.<a class="code" href="structopennsl__l2__station__s.html#ace249a6805ad70b11bef4ee29358d93b" title="Destination MAC address mask value.">dst_mac_mask</a>[3] = 0xff;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    station.<a class="code" href="structopennsl__l2__station__s.html#ace249a6805ad70b11bef4ee29358d93b" title="Destination MAC address mask value.">dst_mac_mask</a>[4] = 0xff;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    station.<a class="code" href="structopennsl__l2__station__s.html#ace249a6805ad70b11bef4ee29358d93b" title="Destination MAC address mask value.">dst_mac_mask</a>[5] = 0xff;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    rv = <a class="code" href="group__l2.html#ga8b8c76a2dd59776079dba4e8e25b681c" title="Add an entry to L2 Station table.">opennsl_l2_station_add</a>(unit, &amp;station_id, &amp;station);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      printf(<span class="stringliteral">&quot;Failed to add L2 station, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  l3if.<a class="code" href="structopennsl__l3__intf__s.html#a1f4aef82705348abe8caec9a827cb5bf" title="See OPENNSL_L3_XXX flag definitions.">l3a_flags</a> = <a class="code" href="group__l3.html#gabf1c04c5421531f00540beca29a95cf5" title="ID is provided.">OPENNSL_L3_WITH_ID</a>;  <span class="comment">/* WITH-ID or without-ID does not really matter. Anyway for now RIF equal VSI */</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">if</span> ((l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ae9a43dcc685930edd966e3ba11482b4c">no_publc</a> == 0) &amp;&amp; ( <span class="comment">/* Update the in_rif to have public searches enabled for vrf == 0 */</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        (l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ab55b1b00e614e76e34c14a1c1c7ea722">vrf</a> == 0 &amp;&amp; <a class="code" href="examples_2util_8h.html#a131ca7039d41fc26c375479724d2f903" title="Returns true if the device is Qumran-MX device.">example_is_qmx_device</a>(unit)) ))</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#aa03ed0ffb6a161dd6384575910498bd8">vrf_valid</a> = 1;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    enable_public = 1;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  l3if.<a class="code" href="structopennsl__l3__intf__s.html#acc865cc8d7ef1ed69ca9d3648ad47c07" title="VLAN ID.">l3a_vid</a> = l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#a564aa639ea097d89c53b16761e2eff0b">vsi</a>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  l3if.<a class="code" href="structopennsl__l3__intf__s.html#afd264ddfcd5088463180739c886a68c7" title="TTL threshold.">l3a_ttl</a> = 31;            <span class="comment">/* default settings */</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="keywordflow">if</span> (l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ab7c506ae16ea0db13b6e90bb84b705ff">ttl_valid</a>) {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    l3if.<a class="code" href="structopennsl__l3__intf__s.html#afd264ddfcd5088463180739c886a68c7" title="TTL threshold.">l3a_ttl</a> = l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#a3e799623c55add91dbaeb522fbcf90b8">ttl</a>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  l3if.<a class="code" href="structopennsl__l3__intf__s.html#a006aee03ae47f03204d59537eb568bc0" title="MTU.">l3a_mtu</a> = 1524;          <span class="comment">/* default settings */</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="keywordflow">if</span> (l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#a6ab767b31e08f16ce24ee4f206498cd0">mtu_valid</a>) {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    l3if.<a class="code" href="structopennsl__l3__intf__s.html#a006aee03ae47f03204d59537eb568bc0" title="MTU.">l3a_mtu</a> = l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ad003167e22301bc1bfa6cd0f8e015893">mtu</a>;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    l3if.<a class="code" href="structopennsl__l3__intf__s.html#a3c7ba8f1b63d62a4ee772245926feeb3" title="Forwarding Layer MTU.">l3a_mtu_forwarding</a> = l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#aedf7a744442fd97a87649ffbe4daca7a">mtu_forwarding</a>;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  l3if.<a class="code" href="structopennsl__l3__intf__s.html#a2e932bc6d690392e54386f95157b3c03" title="Set number of VLAN tags expected when interface is used for native routing.">native_routing_vlan_tags</a> = l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ab0b683220fb713d877f18bb91e195adb">native_routing_vlan_tags</a>;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#a28debc3d8a4a4faeca1205474eb44191">rif</a> = l3if.<a class="code" href="structopennsl__l3__intf__s.html#aad83eb732b3da244ed88ee02531bea82" title="Interface ID.">l3a_intf_id</a> = l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#a564aa639ea097d89c53b16761e2eff0b">vsi</a>;   <span class="comment">/* In DNX Arch VSI always equal RIF */</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  memcpy(l3if.<a class="code" href="structopennsl__l3__intf__s.html#ace9be269a08c66e4420c4a11b1689936" title="MAC address.">l3a_mac_addr</a>, l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#aa6d14a5e6193ff80e19ba88d4b7a4411">my_lsb_mac</a>, 6);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  memcpy(l3if.<a class="code" href="structopennsl__l3__intf__s.html#ace9be269a08c66e4420c4a11b1689936" title="MAC address.">l3a_mac_addr</a>, l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ad17fcf4d0b6a92d48f8f5e1f3e514a10">my_global_mac</a>, 4); <span class="comment">/* ovewriting 4 MSB bytes with global MAC configuration */</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  l3if.<a class="code" href="structopennsl__l3__intf__s.html#a2e932bc6d690392e54386f95157b3c03" title="Set number of VLAN tags expected when interface is used for native routing.">native_routing_vlan_tags</a> = l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ab0b683220fb713d877f18bb91e195adb">native_routing_vlan_tags</a>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  l3if_old.<a class="code" href="structopennsl__l3__intf__s.html#aad83eb732b3da244ed88ee02531bea82" title="Interface ID.">l3a_intf_id</a> = l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#a564aa639ea097d89c53b16761e2eff0b">vsi</a>;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  rv = <a class="code" href="group__l3.html#gaecbb7ded42acdcf76aad0dd8b8a2147d" title="Given the L3 interface number, return the interface information.">opennsl_l3_intf_get</a>(unit, &amp;l3if_old);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="keywordflow">if</span> (rv == <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="comment">/* if L3 INTF already exists, replace it */</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    l3if.<a class="code" href="structopennsl__l3__intf__s.html#a1f4aef82705348abe8caec9a827cb5bf" title="See OPENNSL_L3_XXX flag definitions.">l3a_flags</a> = l3if.<a class="code" href="structopennsl__l3__intf__s.html#a1f4aef82705348abe8caec9a827cb5bf" title="See OPENNSL_L3_XXX flag definitions.">l3a_flags</a> | <a class="code" href="group__l3.html#gafab4c3edb06267658bff13149a593c5f" title="Replace existing entry.">OPENNSL_L3_REPLACE</a>;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    printf(<span class="stringliteral">&quot;intf 0x%x already exist, just replacing\n&quot;</span>,</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        l3if_old.<a class="code" href="structopennsl__l3__intf__s.html#aad83eb732b3da244ed88ee02531bea82" title="Interface ID.">l3a_intf_id</a>);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordflow">if</span> (l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#aaf66536a30054878e119d9acd06ec205">qos_map_valid</a>) {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    l3if.<a class="code" href="structopennsl__l3__intf__s.html#a4aec3a26196f11a3721dbfe50d63b201" title="DSCP QoS Setting.">dscp_qos</a>.<a class="code" href="structopennsl__l3__intf__qos__s.html#aeb29828a01480e1bf6eb4502850b6878" title="QOS Map ID.">qos_map_id</a> = l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ad97ca83a2b0583f72ea9d2a2980184da">qos_map_id</a>;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  rv = <a class="code" href="group__l3.html#ga9706ea196e518e48a9a7940471c7a04d" title="Create a new L3 interface.">opennsl_l3_intf_create</a>(unit, &amp;l3if);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    printf(<span class="stringliteral">&quot;Failed to create L3 interface, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  }</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="keywordflow">if</span> (l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#aa03ed0ffb6a161dd6384575910498bd8">vrf_valid</a> || l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#af3fe053b8eee484b7a2f6aad865f3c48">rpf_valid</a>) {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    l3_ing_if.<a class="code" href="structopennsl__l3__ingress__s.html#aebfa01a97a7e22d12e87977947a410c6" title="Interface flags.">flags</a> = <a class="code" href="group__l3.html#gaffe7430b00fe89bbf5d8b1445518d590" title="L3 Ingress ID is provided.">OPENNSL_L3_INGRESS_WITH_ID</a>;   <span class="comment">/* must, as we update exist RIF */</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    l3_ing_if.<a class="code" href="structopennsl__l3__ingress__s.html#af0b51967b7d9f56282a37303a77e4edb" title="Virtual router id.">vrf</a> = l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ab55b1b00e614e76e34c14a1c1c7ea722">vrf</a>;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">if</span> (l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#af3fe053b8eee484b7a2f6aad865f3c48">rpf_valid</a> &amp;&amp; !is_urpf_mode_per_rif) {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="comment">/* Set uRPF global configuration */</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      rv = <a class="code" href="group__switch.html#gaecf4eb5e6b57081dc8f06c72919e4e0b" title="Configure port-specific and device-wide operating modes.">opennsl_switch_control_set</a>(unit, <a class="code" href="group__switch.html#gga8465f9bee535c4a0c8e4360bcc21e33cad9c6998e810125c80a91102963154f44" title="Port rpf mode for unicast packets.">opennslSwitchL3UrpfMode</a>, l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#a60229d7110ab64661717d6661996ce31">urpf_mode</a>);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      }</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">if</span> (l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ade488a8984e2b1e8117977201ab85e34">flags</a> &amp; <a class="code" href="group__l3.html#ga9083b0d73e5aba69f4d44874100c29b8" title="RPF check.">OPENNSL_L3_RPF</a>) {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      l3_ing_if.<a class="code" href="structopennsl__l3__ingress__s.html#af0e1001b674e6c7805344458e4396893" title="URPF mode setting for L3 Ingress Interface.">urpf_mode</a> = l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#a60229d7110ab64661717d6661996ce31">urpf_mode</a>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      l3_ing_if.<a class="code" href="structopennsl__l3__ingress__s.html#af0e1001b674e6c7805344458e4396893" title="URPF mode setting for L3 Ingress Interface.">urpf_mode</a> = <a class="code" href="group__l3.html#gga9ffd39434b904a446d9ad109a8eef08aa2034af75a4846d03b59e2bb7ac32f133" title="Disable unicast RPF.">opennslL3IngressUrpfDisable</a>;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">if</span> ((l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ab4d364f28625040a59d2082fad36c931">ingress_flags</a> &amp; <a class="code" href="group__l3.html#ga51d5fe02d5f4160e9e856b4ffcdb5559" title="Allow Global Route on L3 Ingress Interface.">OPENNSL_L3_INGRESS_GLOBAL_ROUTE</a>)</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        || ((enable_public == 1) &amp;&amp; <a class="code" href="examples_2util_8h.html#a131ca7039d41fc26c375479724d2f903" title="Returns true if the device is Qumran-MX device.">example_is_qmx_device</a>(unit))) {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      l3_ing_if.<a class="code" href="structopennsl__l3__ingress__s.html#aebfa01a97a7e22d12e87977947a410c6" title="Interface flags.">flags</a> |= <a class="code" href="group__l3.html#ga51d5fe02d5f4160e9e856b4ffcdb5559" title="Allow Global Route on L3 Ingress Interface.">OPENNSL_L3_INGRESS_GLOBAL_ROUTE</a>;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    }</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordflow">if</span> (l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ab4d364f28625040a59d2082fad36c931">ingress_flags</a> &amp; <a class="code" href="group__l3.html#gaf0da8b541ffe4ecec34756e14bcd84f3" title="Trust incoming DSCP on L3 Ingress.">OPENNSL_L3_INGRESS_DSCP_TRUST</a>) {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      l3_ing_if.<a class="code" href="structopennsl__l3__ingress__s.html#aebfa01a97a7e22d12e87977947a410c6" title="Interface flags.">flags</a> |= <a class="code" href="group__l3.html#gaf0da8b541ffe4ecec34756e14bcd84f3" title="Trust incoming DSCP on L3 Ingress.">OPENNSL_L3_INGRESS_DSCP_TRUST</a>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordflow">if</span> (l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#aaf66536a30054878e119d9acd06ec205">qos_map_valid</a>) {</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      l3_ing_if.<a class="code" href="structopennsl__l3__ingress__s.html#a669273334b60b95cbff183a2e6550c79" title="QoS DSCP priority map.">qos_map_id</a> = l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ad97ca83a2b0583f72ea9d2a2980184da">qos_map_id</a>;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    rv = <a class="code" href="group__l3.html#ga3687e6ad79ebc4e99820655e6b4f55b4" title="Create L3 Ingress Interface object.">opennsl_l3_ingress_create</a>(unit, &amp;l3_ing_if, &amp;l3if.<a class="code" href="structopennsl__l3__intf__s.html#aad83eb732b3da244ed88ee02531bea82" title="Interface ID.">l3a_intf_id</a>);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      printf(<span class="stringliteral">&quot;Failed to create L3 ingress interface, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    }</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#a28debc3d8a4a4faeca1205474eb44191">rif</a> = l3if.<a class="code" href="structopennsl__l3__intf__s.html#aad83eb732b3da244ed88ee02531bea82" title="Interface ID.">l3a_intf_id</a>;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  printf</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    (<span class="stringliteral">&quot;created ingress interface = %d, on vlan = %d in unit %d, vrf = %d, skip_mymac:%d  &quot;</span>,</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;     l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#a28debc3d8a4a4faeca1205474eb44191">rif</a>, l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#a564aa639ea097d89c53b16761e2eff0b">vsi</a>, unit, l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ab55b1b00e614e76e34c14a1c1c7ea722">vrf</a>, l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#a9f87e9c3b45045e3138f0078a6338b10">skip_mymac</a>);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  printf(<span class="stringliteral">&quot;mac: %02x:%02x:%02x:%02x:%02x:%02x\n\r&quot;</span>,</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ad17fcf4d0b6a92d48f8f5e1f3e514a10">my_global_mac</a>[0], l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ad17fcf4d0b6a92d48f8f5e1f3e514a10">my_global_mac</a>[1],</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ad17fcf4d0b6a92d48f8f5e1f3e514a10">my_global_mac</a>[2], l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ad17fcf4d0b6a92d48f8f5e1f3e514a10">my_global_mac</a>[3],</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ad17fcf4d0b6a92d48f8f5e1f3e514a10">my_global_mac</a>[4], l3_intf-&gt;<a class="code" href="structcreate__l3__intf__s.html#ad17fcf4d0b6a92d48f8f5e1f3e514a10">my_global_mac</a>[5]);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;}</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00906"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a025f115ed142679975518fd8ac76ca09">  906</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a025f115ed142679975518fd8ac76ca09" title="Create L3 interface on provider_vlan.">example_ip_tunnel_term_create_l3_intf</a>(</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordtype">int</span> unit, <span class="keywordtype">int</span> <a class="code" href="structip__tunnel__glbl__info__s.html#a64cd9f31c970420a8119bc9956c88da6">provider_vlan</a>)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;{</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keywordtype">int</span> rv;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="comment">/* my-mac for LL termination */</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a> my_mac = <a class="code" href="dpp_2example__vxlan_8c.html#aeaa487f5205c0aac9da4e004c173429c">MY_MAC</a>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcreate__l3__intf__s.html">create_l3_intf_s</a> intf;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  memset(&amp;intf, 0, <span class="keyword">sizeof</span>(intf));</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">/* packets income on this vlan with my-mac will be LL termination */</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  intf.<a class="code" href="structcreate__l3__intf__s.html#a564aa639ea097d89c53b16761e2eff0b">vsi</a>           = provider_vlan;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  memcpy(intf.<a class="code" href="structcreate__l3__intf__s.html#ad17fcf4d0b6a92d48f8f5e1f3e514a10">my_global_mac</a>, my_mac, <span class="keyword">sizeof</span>(<a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a>));</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  memcpy(intf.<a class="code" href="structcreate__l3__intf__s.html#aa6d14a5e6193ff80e19ba88d4b7a4411">my_lsb_mac</a>, my_mac, <span class="keyword">sizeof</span>(<a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a>));</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  intf.<a class="code" href="structcreate__l3__intf__s.html#ab4d364f28625040a59d2082fad36c931">ingress_flags</a> = <a class="code" href="group__l3.html#ga51d5fe02d5f4160e9e856b4ffcdb5559" title="Allow Global Route on L3 Ingress Interface.">OPENNSL_L3_INGRESS_GLOBAL_ROUTE</a>; <span class="comment">/* enable public searches */</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#a3a4da3d88b48f189c51ee4f03da1b112" title="Create Router interface.">example_l3_intf_rif_create</a>(unit, &amp;intf);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    printf(<span class="stringliteral">&quot;Failed to create L3 interface, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  g_vxlan.<a class="code" href="structvxlan__s.html#abb2535de38a9772d1086c307e988d1da">prov_vlan_l3_intf_id</a> = intf.<a class="code" href="structcreate__l3__intf__s.html#a28debc3d8a4a4faeca1205474eb44191">rif</a>;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;}</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00939"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#afb4809761bfd3367c7d1ae11a28ffeaf">  939</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#afb4809761bfd3367c7d1ae11a28ffeaf" title="Create IP tunnel termination interface.">example_vxlan_tunnel_terminator_create</a>(</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordtype">int</span> unit, <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a> *in_tunnel_gport_p)</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;{</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keywordtype">int</span> rv;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="comment">/* tunnel term info: according to DIP  only */</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <a class="code" href="structopennsl__tunnel__terminator__s.html" title="L3 tunneling terminator.">opennsl_tunnel_terminator_t</a> ip_tunnel_term;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keyword">struct </span><a class="code" href="structip__tunnel__s.html">ip_tunnel_s</a> ip_tunnel_info = ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#adac12f83da3900c1e0f423c5e2a851f6">ip_tunnel_info</a>;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="comment">/*** create IP tunnel terminator ***/</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <a class="code" href="group__tunnel.html#gae9a2149c3e68ae37b11739ea199f08f5" title="Initialize a opennsl_tunnel_terminator_t structure.">opennsl_tunnel_terminator_t_init</a>(&amp;ip_tunnel_term);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  ip_tunnel_term.<a class="code" href="structopennsl__tunnel__terminator__s.html#a57a7d057bf79bbcfed4db60fd9236b7e" title="DIP for tunnel header match.">dip</a>       = ip_tunnel_info.<a class="code" href="structip__tunnel__s.html#a7498174a2601cd591857b8679055671e">sip</a>;      <span class="comment">/* 170.0.0.17 */</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  ip_tunnel_term.<a class="code" href="structopennsl__tunnel__terminator__s.html#acf11a94221a666cd7581ca3404528ded" title="Destination IP mask.">dip_mask</a>  = 0xFFFFFFFF;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  ip_tunnel_term.<a class="code" href="structopennsl__tunnel__terminator__s.html#a5cbcb1eaa0a16ebc96c576dfc73421b5" title="SIP for tunnel header match.">sip</a>       = ip_tunnel_info.<a class="code" href="structip__tunnel__s.html#a6e2cbabe1620866cc70d11725c36a9e0">dip</a>;      <span class="comment">/* 171.0.0.17 */</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  ip_tunnel_term.<a class="code" href="structopennsl__tunnel__terminator__s.html#abbe9c0b5556f85bdff0962b3e6c5cd1d" title="Source IP mask.">sip_mask</a>  = 0xFFFFFFFF;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  ip_tunnel_term.<a class="code" href="structopennsl__tunnel__terminator__s.html#aa598195e2194e7add6b28b39d0d62b10" title="hierarchical interface.">tunnel_if</a> = -1;    <span class="comment">/* means don&#39;t overwite RIF */</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  ip_tunnel_term.<a class="code" href="structopennsl__tunnel__terminator__s.html#abcc9831103f029841cd0821ec0b0988b" title="Tunnel type.">type</a> = <a class="code" href="group__tunnel.html#gga3e4190fb50ca1bcda4c884af45ca716fac1249e178f6daa961b5ae19195b4b1e1" title="VXLAN Tunnel.">opennslTunnelTypeVxlan</a>;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  rv = <a class="code" href="group__tunnel.html#gad02c6721f4c5f60eedb8010b6e2354b3" title="Add a tunnel terminator for DIP-SIP key.">opennsl_tunnel_terminator_create</a>(unit, &amp;ip_tunnel_term);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    printf(<span class="stringliteral">&quot;Failed to create tunnel terminator, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  }</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 1) {</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    printf(<span class="stringliteral">&quot;created tunnel terminator = 0x%08x \n&quot;</span>, ip_tunnel_term.<a class="code" href="structopennsl__tunnel__terminator__s.html#ad41b511de63a2839f30511f2f03c5302" title="Tunnel id.">tunnel_id</a>);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <a class="code" href="dpp_2example__vxlan_8c.html#a687c7c8830a4913646170e0fb626abc4" title="Utility function to print IP tunnel parameters.">example_ip_tunnel_term_print_key</a>(<span class="stringliteral">&quot;created tunnel term &quot;</span>, &amp;ip_tunnel_term);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  *in_tunnel_gport_p = ip_tunnel_term.<a class="code" href="structopennsl__tunnel__terminator__s.html#ad41b511de63a2839f30511f2f03c5302" title="Tunnel id.">tunnel_id</a>;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;}</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l00978"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a68ddb0d0ce33c08cd1205345ace91018">  978</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a68ddb0d0ce33c08cd1205345ace91018" title="Build IP tunnel.">example_vxlan_egress_tunnel_create</a>(</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordtype">int</span> unit, <span class="keywordtype">int</span> tunnel_vlan, <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a> *tunnel_gportp)</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;{</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="keywordtype">int</span> rv;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="comment">/* tunnel info */</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <a class="code" href="structopennsl__tunnel__initiator__s.html" title="L3 tunneling initiator.">opennsl_tunnel_initiator_t</a> ip_tunnel;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="keyword">struct </span><a class="code" href="structip__tunnel__s.html">ip_tunnel_s</a> ip_tunnel_info = ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#adac12f83da3900c1e0f423c5e2a851f6">ip_tunnel_info</a>;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="keywordtype">int</span> tunnel_itf = 0;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <span class="comment">/*** create tunnel ***/</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <a class="code" href="group__tunnel.html#gaf47bc343029b37da6493ad1608452c49" title="Initialize a opennsl_tunnel_initiator_t structure.">opennsl_tunnel_initiator_t_init</a>(&amp;ip_tunnel);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  ip_tunnel.<a class="code" href="structopennsl__tunnel__initiator__s.html#ae197f0e3771f255246a3b926d77d44d8" title="Tunnel header DIP (IPv4).">dip</a>       = ip_tunnel_info.<a class="code" href="structip__tunnel__s.html#a6e2cbabe1620866cc70d11725c36a9e0">dip</a>;   <span class="comment">/* default: 171.0.0.17 */</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  ip_tunnel.<a class="code" href="structopennsl__tunnel__initiator__s.html#afb622ffe0e32261607929317b796b188" title="Tunnel header SIP (IPv4).">sip</a>       = ip_tunnel_info.<a class="code" href="structip__tunnel__s.html#a7498174a2601cd591857b8679055671e">sip</a>;   <span class="comment">/* default: 170.0.0.17 */</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  ip_tunnel.<a class="code" href="structopennsl__tunnel__initiator__s.html#a32f65c0f4c554ce8490295d15fcd4fc2" title="Configuration flags.">flags</a>    |= ip_tunnel_info.<a class="code" href="structip__tunnel__s.html#aa1eb702ce743171c380383da4576f1e7">flags</a>;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  ip_tunnel.<a class="code" href="structopennsl__tunnel__initiator__s.html#a8c381d8f2f316b82e1d267f0b6eea3ce" title="Tunnel header TTL.">ttl</a>       = ip_tunnel_info.<a class="code" href="structip__tunnel__s.html#ab4b8224cefab5f54172cb75e40434d85">ttl</a>;   <span class="comment">/* default: 50 */</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  ip_tunnel.<a class="code" href="structopennsl__tunnel__initiator__s.html#a99d41099e966760cce3744d7390e6b5c" title="Tunnel type.">type</a>      = ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#ae369a39300829316147880f161f0a0ae">tunnel_type</a>; <span class="comment">/* default: opennslTunnelTypeIpAnyIn4 */</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  ip_tunnel.<a class="code" href="structopennsl__tunnel__initiator__s.html#a1b6cdd436a45137e19bb7c1a59504b4f" title="Tunnel VLAN.">vlan</a>      = tunnel_vlan;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  ip_tunnel.<a class="code" href="structopennsl__tunnel__initiator__s.html#a75caff92c25accc06b8bbd7aea1734e8" title="Tunnel header DSCP select.">dscp_sel</a>  = ip_tunnel_info.<a class="code" href="structip__tunnel__s.html#a0ee0b2ddd7aa5a2014a81307792c7d15">dscp_sel</a>; <span class="comment">/* default: opennslTunnelDscpAssign */</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__tunnel.html#ggac3e728f0dd215de5da9911325eb139d0a99b787675258d897c83a1e346746cec0" title="Set outer IP header DSCP to tunnel initiator DSCP value.">opennslTunnelDscpAssign</a> == ip_tunnel.<a class="code" href="structopennsl__tunnel__initiator__s.html#a75caff92c25accc06b8bbd7aea1734e8" title="Tunnel header DSCP select.">dscp_sel</a>)</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    ip_tunnel.<a class="code" href="structopennsl__tunnel__initiator__s.html#a0e9d4adb9f2174e0bd59cc3db29f6c57" title="Tunnel header DSCP value.">dscp</a>  = ip_tunnel_info.<a class="code" href="structip__tunnel__s.html#a340e44021e9f43b5f40cd811a06b07d8">dscp</a>; <span class="comment">/* default: 11 */</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  }</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  ip_tunnel.<a class="code" href="structopennsl__tunnel__initiator__s.html#ac94faca2f1e1f1b1985205d0cc544437" title="Out LIF counting profile.">outlif_counting_profile</a> = <a class="code" href="dpp_2example__vxlan_8c.html#af6ad039dbf5967db3b9664ea9267d81a">outlif_counting_profile</a>;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#a152a7e2d2abdc2542fd24cb3cd10f25d" title="Create ipv4 tunnel.">example_ip_tunnel_add</a>(unit, &amp;tunnel_itf, &amp;ip_tunnel);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    printf(<span class="stringliteral">&quot;Failed to add IP tunnel, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  }</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 1) {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    printf(<span class="stringliteral">&quot;Created IP tunnel on intf : 0x%08x &quot;</span>, tunnel_itf);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <a class="code" href="examples_2util_8h.html#a8af6968664b72ffda55645d67cb908be" title="To print IP address in dotted decimal format.">print_ip_addr</a>(<span class="stringliteral">&quot; SIP:&quot;</span>, ip_tunnel.<a class="code" href="structopennsl__tunnel__initiator__s.html#afb622ffe0e32261607929317b796b188" title="Tunnel header SIP (IPv4).">sip</a>);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <a class="code" href="examples_2util_8h.html#a8af6968664b72ffda55645d67cb908be" title="To print IP address in dotted decimal format.">print_ip_addr</a>(<span class="stringliteral">&quot; DIP:&quot;</span>, ip_tunnel.<a class="code" href="structopennsl__tunnel__initiator__s.html#ae197f0e3771f255246a3b926d77d44d8" title="Tunnel header DIP (IPv4).">dip</a>);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#af6ad039dbf5967db3b9664ea9267d81a">outlif_counting_profile</a> != <a class="code" href="group__stat.html#gad5497a8abb099bc58967e3fb393f4388" title="An indicator for a LIF to be uncounted.">OPENNSL_STAT_LIF_COUNTING_PROFILE_NONE</a>) {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <a class="code" href="dpp_2example__vxlan_8c.html#a6501cefdf37aa8504bf40ad749d6691e">outlif_to_count2</a> = ip_tunnel.<a class="code" href="structopennsl__tunnel__initiator__s.html#ace61a09c712a58a55daaa3ffec6a9682" title="Tunnel ID.">tunnel_id</a>;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="comment">/*** save it in global data */</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  g_vxlan.<a class="code" href="structvxlan__s.html#a5d21223d761c733751fa1f039ad77c63">tunnel_init_intf_id</a> = tunnel_itf;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="comment">/* refernces to created tunnels as gport */</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  *tunnel_gportp = ip_tunnel.<a class="code" href="structopennsl__tunnel__initiator__s.html#ace61a09c712a58a55daaa3ffec6a9682" title="Tunnel ID.">tunnel_id</a>;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 1) {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    printf(<span class="stringliteral">&quot;created tunnel initiator gport : 0x%08x vlan : %d &quot;</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <span class="stringliteral">&quot;g_vxlan.tunnel_init_intf_id : 0x%08x\n&quot;</span>, *tunnel_gportp,</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        tunnel_vlan, g_vxlan.<a class="code" href="structvxlan__s.html#a5d21223d761c733751fa1f039ad77c63">tunnel_init_intf_id</a>);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;}</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#adb8e51af57ca4e7cac9fcb834bc18aa8"> 1040</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#adb8e51af57ca4e7cac9fcb834bc18aa8" title="Create Egress FEC object.">example_vxlan_egress_tunnel_fec_create</a>(</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordtype">int</span> unit, <span class="keywordtype">int</span> tunnel_vlan,</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordtype">int</span> tunnel_port, <a class="code" href="group__types.html#gaca0e18617c36271957788ac01ba44c2e" title="opennsl_if_t">opennsl_if_t</a> * tunnel_fec_p)</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;{</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="keywordtype">int</span> rv;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="comment">/* tunnel info */</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a> next_hop_mac;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="comment">/*** create egress object: points into tunnel, with allocating FEC, and da-mac = next_hop_mac  ***/</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcreate__l3__egress__s.html">create_l3_egress_s</a> l3eg1;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  memcpy(next_hop_mac, ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#adac12f83da3900c1e0f423c5e2a851f6">ip_tunnel_info</a>.<a class="code" href="structip__tunnel__s.html#aa93c11e74eaac66b07587afdcc3a615e">da</a>, <span class="keyword">sizeof</span>(<a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a>));</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  memset(&amp;l3eg1, 0, <span class="keyword">sizeof</span>(l3eg1));</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  memcpy(l3eg1.<a class="code" href="structcreate__l3__egress__s.html#a3b90370e27f84ad469f110c4e39eee14">next_hop_mac_addr</a>, next_hop_mac, <span class="keyword">sizeof</span>(<a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a>));</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  l3eg1.<a class="code" href="structcreate__l3__egress__s.html#ae7712a901c1185126fbc99ec1c3e05fb">out_tunnel_or_rif</a> = g_vxlan.<a class="code" href="structvxlan__s.html#a5d21223d761c733751fa1f039ad77c63">tunnel_init_intf_id</a>;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  l3eg1.<a class="code" href="structcreate__l3__egress__s.html#ae2aae72d826c0aebbceeab27311787db">out_gport</a>         = <a class="code" href="dpp_2example__vxlan_8c.html#a4ec76d143b6dd3ef786287ce4bae3270">portmap</a>[tunnel_port];</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  l3eg1.<a class="code" href="structcreate__l3__egress__s.html#addaf76f3ca7163ad8983384027515713">vlan</a>              = tunnel_vlan;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  l3eg1.<a class="code" href="structcreate__l3__egress__s.html#a660e3c6d1170a31969e568b04dccbe7a">fec_id</a> = 0;             <span class="comment">/* This may not matter so much, sarath */</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  l3eg1.<a class="code" href="structcreate__l3__egress__s.html#aa475f6c0813d25042d984bdd93eec535">arp_encap_id</a> = 0;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#a4e714391e0198579d1509fd5231af009" title="Create L3 egress object for FEC and ARP entry.">example_l3_egress_create</a>(unit, &amp;l3eg1);</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    printf(<span class="stringliteral">&quot;Failed to create L3 egress object, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="comment">/* interface for ip_tunnel is egress-object (FEC) */</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  *tunnel_fec_p = l3eg1.<a class="code" href="structcreate__l3__egress__s.html#a660e3c6d1170a31969e568b04dccbe7a">fec_id</a>;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 1) {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    printf(<span class="stringliteral">&quot;Created FEC-id = 0x%08x\n&quot;</span>, *tunnel_fec_p);</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;}</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a152a7e2d2abdc2542fd24cb3cd10f25d"> 1087</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a152a7e2d2abdc2542fd24cb3cd10f25d" title="Create ipv4 tunnel.">example_ip_tunnel_add</a>(<span class="keywordtype">int</span> unit, <a class="code" href="group__types.html#gaca0e18617c36271957788ac01ba44c2e" title="opennsl_if_t">opennsl_if_t</a> * itf,</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <a class="code" href="structopennsl__tunnel__initiator__s.html" title="L3 tunneling initiator.">opennsl_tunnel_initiator_t</a> * <a class="code" href="opennsl__api_8dox.html#aa5eb3d2bb92909819359b4fd24749880">tunnel</a>)</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;{</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <a class="code" href="structopennsl__l3__intf__s.html" title="L3 Interface Structure.">opennsl_l3_intf_t</a> l3_intf;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="keywordtype">int</span> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <a class="code" href="group__l3.html#gaa92edab97138caed29fe11f4f9b35fa7" title="Initialize a opennsl_l3_intf_t structure.">opennsl_l3_intf_t_init</a>(&amp;l3_intf);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="comment">/* if given ID is set, then use it as placement of the ipv4-tunnel */</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="keywordflow">if</span> (*itf != 0) {</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <a class="code" href="group__types.html#gac6d19ddb0a45a93b8b99ddb0c7422194">OPENNSL_GPORT_TUNNEL_ID_SET</a>(tunnel-&gt;<a class="code" href="structopennsl__tunnel__initiator__s.html#ace61a09c712a58a55daaa3ffec6a9682" title="Tunnel ID.">tunnel_id</a>, *itf);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    tunnel-&gt;<a class="code" href="structopennsl__tunnel__initiator__s.html#a32f65c0f4c554ce8490295d15fcd4fc2" title="Configuration flags.">flags</a> |= <a class="code" href="group__tunnel.html#gab4f2d80d4d2e9aca71a07e0f6bc19858" title="Add using the specified ID.">OPENNSL_TUNNEL_WITH_ID</a>;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  }</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  rv = <a class="code" href="group__tunnel.html#ga847d52df4fabf270271ca1b88e94cf95" title="Set the tunneling initiator parameters on an L3 interface.">opennsl_tunnel_initiator_create</a>(unit, &amp;l3_intf, tunnel);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    printf(<span class="stringliteral">&quot;Failed to create tunnel initiator, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  }</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="comment">/* include interface-id points to the tunnel */</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  *itf = l3_intf.<a class="code" href="structopennsl__l3__intf__s.html#aad83eb732b3da244ed88ee02531bea82" title="Interface ID.">l3a_intf_id</a>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;}</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a0b8948666e6b815b34588008f4aef977"> 1121</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a0b8948666e6b815b34588008f4aef977" title="To initialize vxlan_port_add_s.">example_vxlan_port_s_clear</a>(</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keyword">struct</span> <a class="code" href="structvxlan__port__add__s.html">vxlan_port_add_s</a> * vxlan_port_add)</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;{</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  memset(vxlan_port_add, 0, <span class="keyword">sizeof</span>(*vxlan_port_add));</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="comment">/* by default, egress orientatino is set by vxlan port */</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  vxlan_port_add-&gt;<a class="code" href="structvxlan__port__add__s.html#a7fbbe076345119b05d4822d047be833b">set_egress_orientation_using_vxlan_port_add</a> = 1;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;}</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a16d117a09a5c6ed09709fea3bc458ed1"> 1145</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a16d117a09a5c6ed09709fea3bc458ed1" title="Add gport of type vlan-port to the multicast.">example_multicast_vxlan_port_add</a>(<span class="keywordtype">int</span> unit, <span class="keywordtype">int</span> mc_group_id,</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="keywordtype">int</span> sys_port, <span class="keywordtype">int</span> gport, <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> is_egress)</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;{</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="keywordtype">int</span> encap_id;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keywordtype">int</span> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  rv = <a class="code" href="group__multicast.html#gafc7e3a95a0a18021de98480a83aeb351" title="Get the multicast encapsulation ID for VXLAN replication.">opennsl_multicast_vxlan_encap_get</a>(unit, mc_group_id, sys_port, gport, &amp;encap_id);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    printf</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      (<span class="stringliteral">&quot;Failed to vxlan encapsulation ID for mc_group_id: 0x%08x &quot;</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;       <span class="stringliteral">&quot;phy_port: 0x%08x gport: 0x%08x, Error %s\n&quot;</span>,</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;       mc_group_id, sys_port, gport, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  }</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  rv = <a class="code" href="group__multicast.html#gafa55f761fe7a9b6026267234c3fd7057" title="Add a port to a Ingress Multicast group&#39;s replication list.">opennsl_multicast_ingress_add</a>(unit, mc_group_id, sys_port, encap_id);</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="comment">/* if the MC entry already exist, then we shouldn&#39;t add it twice to the multicast group */</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keywordflow">if</span> (rv == <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5ad03e135eecd46c9c1280e7b3f6ab5b6a">OPENNSL_E_EXISTS</a>) {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    printf(<span class="stringliteral">&quot;The multicast entry already exists \n&quot;</span>);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    printf(<span class="stringliteral">&quot;Failed to update ingress multicast group for mc_group_id: 0x%08x &quot;</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <span class="stringliteral">&quot;phy_port: 0x%08x encap_id: 0x%08x, Error %s\n&quot;</span>,</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;        mc_group_id, sys_port, encap_id, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  }</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  printf(<span class="stringliteral">&quot;Added sys_port %d to mc_group_id %d encap_id: 0x%08x\n&quot;</span>, sys_port, mc_group_id, encap_id);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;}</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a7ed94e934f01fbde62c6d0d5ce55ac95"> 1185</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a7ed94e934f01fbde62c6d0d5ce55ac95" title="To create VxLAN port.">example_vxlan_port_add</a>(</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordtype">int</span> unit, <span class="keyword">struct</span> <a class="code" href="structvxlan__port__add__s.html">vxlan_port_add_s</a> *vxlan_port_add)</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;{</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="keywordtype">int</span> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <a class="code" href="structopennsl__vxlan__port__s.html" title="VXLAN Gport.">opennsl_vxlan_port_t</a> vxlan_port;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <a class="code" href="group__vxlan.html#gabb37c026d44cf86b88db9b746864678c" title="Initialize VXLAN port structure.">opennsl_vxlan_port_t_init</a>(&amp;vxlan_port);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  vxlan_port.<a class="code" href="structopennsl__vxlan__port__s.html#a55833885a33e3b4564f244eb739366f0" title="Match criteria.">criteria</a>         = <a class="code" href="group__vxlan.html#gga4600e13897e04ce6c7eef1ea4c52a97aa95dd2a39582292c5434afce67210ca12" title="Match VXLAN VN_ID.">OPENNSL_VXLAN_PORT_MATCH_VN_ID</a>;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  vxlan_port.<a class="code" href="structopennsl__vxlan__port__s.html#a7db9ca71d49c4d5adb2452eb7f37bd69" title="Match port / trunk.">match_port</a>       = vxlan_port_add-&gt;<a class="code" href="structvxlan__port__add__s.html#aa63b6f1c4a3906da1dd79446e2606d30">in_port</a>;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  vxlan_port.<a class="code" href="structopennsl__vxlan__port__s.html#aa3c53f3028118b7e98d3547e179e25eb" title="Tunnel Terminator ID.">match_tunnel_id</a>  = vxlan_port_add-&gt;<a class="code" href="structvxlan__port__add__s.html#ab32e0326829e5a9ebd5437a924286e9f">in_tunnel</a>;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  vxlan_port.<a class="code" href="structopennsl__vxlan__port__s.html#abede24b43e4492ea401abe937bc24b47" title="VXLAN egress object.">egress_if</a>        = vxlan_port_add-&gt;<a class="code" href="structvxlan__port__add__s.html#a79ce4d83e6ef740255e7a2c76c8a05ad">egress_if</a>;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  vxlan_port.<a class="code" href="structopennsl__vxlan__port__s.html#a66bd0455a644c92731efa6997b53d709" title="Tunnel Initiator ID.">egress_tunnel_id</a> = vxlan_port_add-&gt;<a class="code" href="structvxlan__port__add__s.html#a15fadc6bc382fbd97c2b669987ce0c5e">out_tunnel</a>;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  vxlan_port.<a class="code" href="structopennsl__vxlan__port__s.html#ab25ba86e1f740cefc25bcfe66511afb0" title="OPENNSL_VXLAN_PORT_xxx.">flags</a>            = vxlan_port_add-&gt;<a class="code" href="structvxlan__port__add__s.html#a65c03fc2e80c752f9caa54e9e4c7eb48">flags</a> | <a class="code" href="group__vxlan.html#ga970a0937f71cff5f48e85b2be086aeb2" title="Specified Egress tunnel is valid.">OPENNSL_VXLAN_PORT_EGRESS_TUNNEL</a>;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="comment">/* set orientation, work for Jericho.</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">   * For Jericho, we configure orientation at ingress (inLif) and egress (outLif): </span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">   * ingress orientation is configured at opennsl_vxlan_port_add. </span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment">   * egress orientation can be configured using opennsl_vxlan_port_add or at opennsl_port_class_set</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="comment">/* flag indicating network orientation.</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">   * Used to configure ingress orientation and optionally egress orientation */</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  vxlan_port.<a class="code" href="structopennsl__vxlan__port__s.html#ab25ba86e1f740cefc25bcfe66511afb0" title="OPENNSL_VXLAN_PORT_xxx.">flags</a> |= <a class="code" href="group__vxlan.html#gabc6fe5af508cc9e898aa992bdf981db1" title="Network facing interface.">OPENNSL_VXLAN_PORT_NETWORK</a>;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  vxlan_port.<a class="code" href="structopennsl__vxlan__port__s.html#a834e366d60729310f76dcfdefa7fe495" title="Split Horizon network group identifier.">network_group_id</a> = vxlan_port_add-&gt;<a class="code" href="structvxlan__port__add__s.html#a3c72b692b025ba9c797e178e6df99ec1">network_group_id</a>; <span class="comment">/* TO FIX g_vxlan.vxlan_network_group_id;  */</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  rv = <a class="code" href="group__vxlan.html#ga436707cb4c75c0ecf856e2859f878ef5" title="opennsl_vxlan_port_add adds a Access or Network VXLAN port.">opennsl_vxlan_port_add</a>(unit, vxlan_port_add-&gt;<a class="code" href="structvxlan__port__add__s.html#a871ac564d33b78b193bba71ab8007acb">vpn</a>, &amp;vxlan_port);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    printf(<span class="stringliteral">&quot;Failed to add vxlan port, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  vxlan_port_add-&gt;<a class="code" href="structvxlan__port__add__s.html#a2d496e06482a0c065da46ceb7fe2f9c3">vxlan_port_id</a> = vxlan_port.<a class="code" href="structopennsl__vxlan__port__s.html#ad75a73a038313fbb6412b11c99a8410b" title="GPORT identifier.">vxlan_port_id</a>;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 2) {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    printf(<span class="stringliteral">&quot;vxlan port created, vxlan_port_id: 0x%08x \n&quot;</span>,</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        vxlan_port.<a class="code" href="structopennsl__vxlan__port__s.html#ad75a73a038313fbb6412b11c99a8410b" title="GPORT identifier.">vxlan_port_id</a>);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    printf(<span class="stringliteral">&quot;vxlan port is config with:\n&quot;</span>);</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    printf(<span class="stringliteral">&quot;  ip in tunnel termination gport:0x%08x  \n&quot;</span>, vxlan_port_add-&gt;<a class="code" href="structvxlan__port__add__s.html#ab32e0326829e5a9ebd5437a924286e9f">in_tunnel</a>);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordflow">if</span> (vxlan_port_add-&gt;<a class="code" href="structvxlan__port__add__s.html#a79ce4d83e6ef740255e7a2c76c8a05ad">egress_if</a> != 0) {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      printf(<span class="stringliteral">&quot;  FEC entry (contains ip tunnel encapsulation information):0x%08x \n&quot;</span>,</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;          vxlan_port_add-&gt;<a class="code" href="structvxlan__port__add__s.html#a79ce4d83e6ef740255e7a2c76c8a05ad">egress_if</a>);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      printf(<span class="stringliteral">&quot;  ip tunnel initiator gport:0x%08x\n&quot;</span>, vxlan_port_add-&gt;<a class="code" href="structvxlan__port__add__s.html#a15fadc6bc382fbd97c2b669987ce0c5e">out_tunnel</a>);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    printf(<span class="stringliteral">&quot;  vpn: 0x%08x\n\r&quot;</span>, vxlan_port_add-&gt;<a class="code" href="structvxlan__port__add__s.html#a871ac564d33b78b193bba71ab8007acb">vpn</a>);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    printf(<span class="stringliteral">&quot;  vxlan lif orientation: network_group_id = %d\n\r&quot;</span>, vxlan_port_add-&gt;<a class="code" href="structvxlan__port__add__s.html#a3c72b692b025ba9c797e178e6df99ec1">network_group_id</a>);</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  }</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#a16d117a09a5c6ed09709fea3bc458ed1" title="Add gport of type vlan-port to the multicast.">example_multicast_vxlan_port_add</a>(unit, g_vxlan.<a class="code" href="structvxlan__s.html#a1b647ccd563354898062549280703bb9">mc_group_id</a>,</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      vxlan_port.<a class="code" href="structopennsl__vxlan__port__s.html#a7db9ca71d49c4d5adb2452eb7f37bd69" title="Match port / trunk.">match_port</a>, vxlan_port.<a class="code" href="structopennsl__vxlan__port__s.html#ad75a73a038313fbb6412b11c99a8410b" title="GPORT identifier.">vxlan_port_id</a>, <a class="code" href="example__cos_8c.html#a8b5659941298c6f209a80a5bb61b6bf7">egress_mc</a>);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    printf(<span class="stringliteral">&quot;Failed to add vxlan port to multicast group, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  }</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 2) {</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    printf(<span class="stringliteral">&quot;add vxlan-port 0x%08x to VPN flooding group %d (0x%08x)\n\r&quot;</span>,</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        vxlan_port.<a class="code" href="structopennsl__vxlan__port__s.html#ad75a73a038313fbb6412b11c99a8410b" title="GPORT identifier.">vxlan_port_id</a>, g_vxlan.<a class="code" href="structvxlan__s.html#a1b647ccd563354898062549280703bb9">mc_group_id</a>, g_vxlan.<a class="code" href="structvxlan__s.html#a1b647ccd563354898062549280703bb9">mc_group_id</a>);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;}</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a7c09d41cae87a4d1d2fa5164e035335b"> 1256</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="dpp_2example__vxlan_8c.html#a7c09d41cae87a4d1d2fa5164e035335b" title="To initialize the global VxLAN structure.">vxlan_init</a>(<span class="keywordtype">int</span> unit, <span class="keyword">struct</span> <a class="code" href="structvxlan__s.html">vxlan_s</a> *vx_info)</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;{</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <span class="keywordflow">if</span> (vx_info != <a class="code" href="sal_2types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    memcpy(&amp;g_vxlan, vx_info, <span class="keyword">sizeof</span>(g_vxlan));</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;}</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a268488e2ad7ba73eafea58bd298bcce3"> 1272</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="dpp_2example__vxlan_8c.html#a268488e2ad7ba73eafea58bd298bcce3" title="To copy the global VxLAN structure.">vxlan_struct_get</a>(<span class="keyword">struct</span> <a class="code" href="structvxlan__s.html">vxlan_s</a> *vx_info)</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;{</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  memcpy(vx_info, &amp;g_vxlan, <span class="keyword">sizeof</span>(g_vxlan));</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;}</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a0a0ecff77aba73348c6bd59869101f1d"> 1287</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a0a0ecff77aba73348c6bd59869101f1d" title="To build L2 VPN.">example_vxlan_open_vpn</a>(<span class="keywordtype">int</span> unit, <span class="keywordtype">int</span> vpn, <span class="keywordtype">int</span> vni)</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;{</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <span class="keywordtype">int</span> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="keywordtype">int</span> mc_group_id = vpn;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <a class="code" href="example__cos_8c.html#a8b5659941298c6f209a80a5bb61b6bf7">egress_mc</a> = 0;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#ac7704d686c6c44bb0da37824d699966d" title="Utility function to create multicast group.">example_multicast_group_open</a>(unit, &amp;mc_group_id,</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      <a class="code" href="group__multicast.html#gaa76a6dd0b85d5ddc43cea2c36df48b4e">OPENNSL_MULTICAST_TYPE_L2</a>);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    printf(<span class="stringliteral">&quot;Failed to create multicast group, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  }</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <a class="code" href="structopennsl__vxlan__vpn__config__s.html" title="VXLAN VPN Config Structure.">opennsl_vxlan_vpn_config_t</a> vpn_config;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <a class="code" href="group__vxlan.html#ga6714301b6f97f14df45b8e96f26cbae8" title="Initialize VXLAN VPN config structure.">opennsl_vxlan_vpn_config_t_init</a>(&amp;vpn_config);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  vpn_config.<a class="code" href="structopennsl__vxlan__vpn__config__s.html#a16136c29ade623ced30606f46e7ff6d5" title="OPENNSL_VXLAN_VPN_xxx.">flags</a> =</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <a class="code" href="group__vxlan.html#ga40d3a155a0639cf603ce0fddc8765e87">OPENNSL_VXLAN_VPN_ELAN</a> | <a class="code" href="group__vxlan.html#ga91cf169bff8103ae7e80bf2f437a3725">OPENNSL_VXLAN_VPN_WITH_ID</a> | <a class="code" href="group__vxlan.html#gad5f555e90830304d8338b723f9239698">OPENNSL_VXLAN_VPN_WITH_VPNID</a>;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  vpn_config.<a class="code" href="structopennsl__vxlan__vpn__config__s.html#afbf3610c95f5cf94a92c79259b65211c" title="VXLAN VPN.">vpn</a>                      = vpn;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  vpn_config.<a class="code" href="structopennsl__vxlan__vpn__config__s.html#a497586a6d6f0ce3195a29975068e1461">broadcast_group</a>          = mc_group_id;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  vpn_config.<a class="code" href="structopennsl__vxlan__vpn__config__s.html#a1105297de06ffd03b750d7f46c8ea12d">unknown_unicast_group</a>    = mc_group_id;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  vpn_config.<a class="code" href="structopennsl__vxlan__vpn__config__s.html#afa48be63476fbb0faff6317d8748446c">unknown_multicast_group</a>  = mc_group_id;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  vpn_config.<a class="code" href="structopennsl__vxlan__vpn__config__s.html#a662233db9e571082acf8eeb89d495a68" title="VNID.">vnid</a>                     = vni;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keywordflow">if</span> (g_vxlan.<a class="code" href="structvxlan__s.html#ae7d8ca029ccb27c998e23699eb540e5d">vxlan_vdc_enable</a>) {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    vpn_config.<a class="code" href="structopennsl__vxlan__vpn__config__s.html#a6d953c779cdc613e2510713c27fecd21" title="local port vlan domain">match_port_class</a> = <a class="code" href="dpp_2example__vxlan_8c.html#a7df647d7b39028bae7fc129cbc272eb5">vdc_port_class</a>;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  }</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  rv = <a class="code" href="group__vxlan.html#ga7a04195dfb41f6db86a90a1b865962c8" title="Create or update VXLAN VPN.">opennsl_vxlan_vpn_create</a>(unit, &amp;vpn_config);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    printf(<span class="stringliteral">&quot;Failed to create vxlan vpn, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  }</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 1) {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    printf(<span class="stringliteral">&quot;Created vpn %d (0x%08x)\n\r&quot;</span>, vpn, vpn);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  }</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;}</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a9fa34635706aa7d06850dabda9969220"> 1336</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a9fa34635706aa7d06850dabda9969220" title="To create inLif for a port.">example_vlan_inLif_create</a>(<span class="keywordtype">int</span> unit, <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a> in_port,</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a> *port_id)</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;{</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <span class="keywordtype">int</span> rv;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <a class="code" href="structopennsl__vlan__port__s.html" title="Layer 2 Logical port type.">opennsl_vlan_port_t</a> vport1;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <a class="code" href="group__vlan.html#gaa1bf59398c66fd46c9109b4fc9d79051" title="Initialize the VLAN port structure.">opennsl_vlan_port_t_init</a>(&amp;vport1);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  vport1.<a class="code" href="structopennsl__vlan__port__s.html#ab94d90776edeb955129f95b07f287181" title="Match criteria.">criteria</a>        = <a class="code" href="group__vlan.html#ggac691cd787b4b6aa9a2f8b83659d4af50a0e8e71613acf7f6159c59d446e5bb1d0" title="Mod/port/trunk + outer VLAN.">OPENNSL_VLAN_PORT_MATCH_PORT_VLAN</a>;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  vport1.<a class="code" href="structopennsl__vlan__port__s.html#a38cc4cd1deb11194217fc3eed635b108" title="Gport: local or remote Physical or logical gport.">port</a>            = in_port;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  vport1.<a class="code" href="structopennsl__vlan__port__s.html#a10ec33efb60f9917b243dd872dc3858f" title="Outer VLAN ID to match.">match_vlan</a>      = ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#a21b5a34ff96e8fe80f8068d3790871d6">access_vlan</a>;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;  vport1.<a class="code" href="structopennsl__vlan__port__s.html#aae4bfab581619f524b69104a589634bb" title="Egress Outer VLAN or SD-TAG VLAN ID.">egress_vlan</a>     = ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#a21b5a34ff96e8fe80f8068d3790871d6">access_vlan</a>;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  vport1.<a class="code" href="structopennsl__vlan__port__s.html#a7780aaa81891b515df40ae3696db218b" title="OPENNSL_VLAN_PORT_xxx.">flags</a>           = 0;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  vport1.<a class="code" href="structopennsl__vlan__port__s.html#a3180209e53566f3050a304955fabe8ff" title="Populated for opennsl_vlan_port_find only.">vsi</a>             = 0;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  rv = <a class="code" href="group__vlan.html#ga019a29bf98cbf78d0b609f3e1b00d473" title="Create a layer 2 logical port.">opennsl_vlan_port_create</a>(unit, &amp;vport1);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    printf(<span class="stringliteral">&quot;Failed to create vlan_port filter, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  }</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 2) {</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    printf</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      (<span class="stringliteral">&quot;Add vlan-port-id: 0x%08x in-port: %d (0x%08x) match_vlan: %d &quot;</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;       <span class="stringliteral">&quot;egress_vlan: %d match_inner_vlan: %d\n\r&quot;</span>, vport1.<a class="code" href="structopennsl__vlan__port__s.html#a6bf4ca3edeb7068c9baea003faad1f52" title="GPORT identifier.">vlan_port_id</a>,</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;       vport1.<a class="code" href="structopennsl__vlan__port__s.html#a38cc4cd1deb11194217fc3eed635b108" title="Gport: local or remote Physical or logical gport.">port</a>, vport1.<a class="code" href="structopennsl__vlan__port__s.html#a38cc4cd1deb11194217fc3eed635b108" title="Gport: local or remote Physical or logical gport.">port</a>, vport1.<a class="code" href="structopennsl__vlan__port__s.html#a10ec33efb60f9917b243dd872dc3858f" title="Outer VLAN ID to match.">match_vlan</a>, vport1.<a class="code" href="structopennsl__vlan__port__s.html#aae4bfab581619f524b69104a589634bb" title="Egress Outer VLAN or SD-TAG VLAN ID.">egress_vlan</a>,</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;       vport1.<a class="code" href="structopennsl__vlan__port__s.html#a6a6a74cf200a3ff06e4be8e4d4102f6c" title="Inner VLAN ID to match.">match_inner_vlan</a>);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  }</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  <span class="comment">/* handle of the created gport */</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  *port_id = vport1.<a class="code" href="structopennsl__vlan__port__s.html#a6bf4ca3edeb7068c9baea003faad1f52" title="GPORT identifier.">vlan_port_id</a>;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;}</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a5bd99907b1249af4dc595c4d17b727b3"> 1382</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="dpp_2example__vxlan_8c.html#a5bd99907b1249af4dc595c4d17b727b3" title="Main function to build VxLAN IP tunnel.">example_vxlan</a>(</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keywordtype">int</span> unit,</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="keywordtype">int</span> network_port,</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordtype">int</span> access_port,</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordtype">int</span> vpn_id)</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;{</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <span class="keywordtype">int</span> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  <span class="keywordtype">int</span> vxlan_port_flags = 0;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <span class="keyword">struct </span><a class="code" href="structvxlan__port__add__s.html">vxlan_port_add_s</a> vxlan_port_add;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="comment">/* init vxlan global */</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  <span class="keyword">struct </span><a class="code" href="structvxlan__s.html">vxlan_s</a> vxlan_param;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  <a class="code" href="dpp_2example__vxlan_8c.html#a268488e2ad7ba73eafea58bd298bcce3" title="To copy the global VxLAN structure.">vxlan_struct_get</a>(&amp;vxlan_param);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  <span class="keywordflow">if</span> (vpn_id &gt;= 0) {</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    vxlan_param.<a class="code" href="structvxlan__s.html#ad86bc71950683d29530ca040aaf545fe">vpn_id</a> = <a class="code" href="structvxlan__s.html#ad86bc71950683d29530ca040aaf545fe">vpn_id</a>;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <a class="code" href="dpp_2example__vxlan_8c.html#a7c09d41cae87a4d1d2fa5164e035335b" title="To initialize the global VxLAN structure.">vxlan_init</a>(unit, &amp;vxlan_param);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  vpn_id = g_vxlan.<a class="code" href="structvxlan__s.html#ad86bc71950683d29530ca040aaf545fe">vpn_id</a>;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  <a class="code" href="dpp_2example__vxlan_8c.html#a250f8b62242774ce141a27acb9752aaa" title="OTP portmap for DNX device.">init_portmap</a>(unit);</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  printf(<span class="stringliteral">&quot;Parameters \n&quot;</span>);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  printf(<span class="stringliteral">&quot;Ports (Network: %d, Access: %d)\n&quot;</span>, network_port, access_port);</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  printf(<span class="stringliteral">&quot;Vlans (Provider:%d Tunnel:%d Access:%d)\n&quot;</span>,</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#a64cd9f31c970420a8119bc9956c88da6">provider_vlan</a>,</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#ac06eafb784664031824be6cdda096566">tunnel_vlan</a>,</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#a21b5a34ff96e8fe80f8068d3790871d6">access_vlan</a>);</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  printf(<span class="stringliteral">&quot;VPN: %d VNI: %d(0x%x)\n&quot;</span>, vpn_id, g_vxlan.<a class="code" href="structvxlan__s.html#abe6f1f9f9213a49e63de056544cb4191">vni</a>, g_vxlan.<a class="code" href="structvxlan__s.html#abe6f1f9f9213a49e63de056544cb4191">vni</a>);</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  g_vxlan.<a class="code" href="structvxlan__s.html#aed1548bcb4778c489fee321cb8070add">access_port</a>  = <a class="code" href="structvxlan__s.html#aed1548bcb4778c489fee321cb8070add">access_port</a>;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  g_vxlan.<a class="code" href="structvxlan__s.html#a920ac099de8959b39b8f02076afd837f">network_port</a> = <a class="code" href="structvxlan__s.html#a920ac099de8959b39b8f02076afd837f">network_port</a>;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  <a class="code" href="dpp_2example__vxlan_8c.html#a0b8948666e6b815b34588008f4aef977" title="To initialize vxlan_port_add_s.">example_vxlan_port_s_clear</a>(&amp;vxlan_port_add);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  <span class="comment">/* config ports as local ports i.e Works as egress port */</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  <a class="code" href="group__switch.html#gaecf4eb5e6b57081dc8f06c72919e4e0b" title="Configure port-specific and device-wide operating modes.">opennsl_switch_control_set</a>(unit, <a class="code" href="group__switch.html#gga8465f9bee535c4a0c8e4360bcc21e33ca2bd885f05e90af619d58cb5c41fab717" title="Set UDP Destination port for VXLAN.">opennslSwitchVxlanUdpDestPortSet</a>, 0x12b5);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  <a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> = 10;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <span class="comment">/* init L2 VXLAN module */</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  rv = <a class="code" href="group__vxlan.html#ga264a5af1920511d7b3318483414448e7" title="Initialize the OPENNSL VXLAN subsystem.">opennsl_vxlan_init</a>(unit);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    printf(<span class="stringliteral">&quot;Failed to initialize vxlan, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  }</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  <span class="comment">/*** Add the ports to VLANs ***/</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  <a class="code" href="dpp_2example__vxlan_8c.html#ad74eca815fd91ca5fda606965f3468c5" title="Utility function to add ports to relevant VLAN&#39;s.">example_add_ports_to_vlans</a>(unit, network_port, access_port);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  <span class="comment">/* build L2 VPN */</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#a0a0ecff77aba73348c6bd59869101f1d" title="To build L2 VPN.">example_vxlan_open_vpn</a>(unit, vpn_id, g_vxlan.<a class="code" href="structvxlan__s.html#abe6f1f9f9213a49e63de056544cb4191">vni</a>);</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    printf(<span class="stringliteral">&quot;Failed to open vpn %d, Error %s\n&quot;</span>, vpn_id, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <span class="comment">/* Create inLif for access port */</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#a9fa34635706aa7d06850dabda9969220" title="To create inLif for a port.">example_vlan_inLif_create</a>(unit, access_port, &amp;g_vxlan.<a class="code" href="structvxlan__s.html#a216de94dfb7c6b4dee49c39ac0d075d5">vlan_inLif</a>);</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    printf(<span class="stringliteral">&quot;Failed to create VLAN inLIF 0x%08x, Error %s\n&quot;</span>, g_vxlan.<a class="code" href="structvxlan__s.html#a216de94dfb7c6b4dee49c39ac0d075d5">vlan_inLif</a>,</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  }</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <span class="comment">/* Add inLif to VSI and add it flood MC group */</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#a420d8c462502c6c006b9382625dc1048" title="Add gport of type vlan-port to the multicast.">example_add_inLif_to_vswitch</a>(unit, vpn_id, access_port, g_vxlan.<a class="code" href="structvxlan__s.html#a216de94dfb7c6b4dee49c39ac0d075d5">vlan_inLif</a>);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    printf(<span class="stringliteral">&quot;Failed to add inLif to VSI or adding access port to multicast &quot;</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        <span class="stringliteral">&quot;group, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <span class="comment">/*** build tunnel initiator ***/</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#a68ddb0d0ce33c08cd1205345ace91018" title="Build IP tunnel.">example_vxlan_egress_tunnel_create</a>(unit, ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#ac06eafb784664031824be6cdda096566">tunnel_vlan</a>,</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      &amp;g_vxlan.<a class="code" href="structvxlan__s.html#a7dde8b90deec0c176991dbff88289f35">tunnel_init_gport</a>);</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    printf(<span class="stringliteral">&quot;Failed to build tunnel initiator network_port %d, Error %s\n&quot;</span>,</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        network_port, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="comment">/*** build tunnel FEC ***/</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#adb8e51af57ca4e7cac9fcb834bc18aa8" title="Create Egress FEC object.">example_vxlan_egress_tunnel_fec_create</a>(unit, ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#ac06eafb784664031824be6cdda096566">tunnel_vlan</a>,</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      network_port, &amp;g_vxlan.<a class="code" href="structvxlan__s.html#a8bb65f9081317e27044d587510e2fed7">vxlan_fec_intf_id</a>);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    printf(<span class="stringliteral">&quot;Failed to create FEC, network_port %d, Error %s\n&quot;</span>,</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        network_port, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 2) {</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    printf(<span class="stringliteral">&quot;out-tunnel gport-id: 0x%08x FEC-id:0x%08x\n\r&quot;</span>,</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        g_vxlan.<a class="code" href="structvxlan__s.html#a7dde8b90deec0c176991dbff88289f35">tunnel_init_gport</a>, g_vxlan.<a class="code" href="structvxlan__s.html#a8bb65f9081317e27044d587510e2fed7">vxlan_fec_intf_id</a>);</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  }</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="comment">/* tunnel termination configuration */</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  <span class="keywordflow">if</span> (g_vxlan.<a class="code" href="structvxlan__s.html#ae31c573d0a4c39166a520e58375a7cd2">dip_sip_vrf_using_my_vtep_index_mode</a> == 0) {</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="comment">/*** build tunnel termination  ***/</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    rv = <a class="code" href="dpp_2example__vxlan_8c.html#afb4809761bfd3367c7d1ae11a28ffeaf" title="Create IP tunnel termination interface.">example_vxlan_tunnel_terminator_create</a>(unit, &amp;g_vxlan.<a class="code" href="structvxlan__s.html#a6d8b46cddca08debd4645f38e008dab5">tunnel_term_gport</a>);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      printf(<span class="stringliteral">&quot;Failed to build tunnel termination, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    }</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <span class="comment">/*** create L3 interface on provider_vlan, not using it explicitly, but used in pipeline */</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    rv = <a class="code" href="dpp_2example__vxlan_8c.html#a025f115ed142679975518fd8ac76ca09" title="Create L3 interface on provider_vlan.">example_ip_tunnel_term_create_l3_intf</a>(unit, ip_tunnel_glbl_info.<a class="code" href="structip__tunnel__glbl__info__s.html#a64cd9f31c970420a8119bc9956c88da6">provider_vlan</a>);</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;      printf(<span class="stringliteral">&quot;Failed to create L3 interface on provider VLAN, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    }</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 2) {</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      printf(<span class="stringliteral">&quot;in-tunnel gport-id: 0x%08x L3 itf:%x\r&quot;</span>, g_vxlan.<a class="code" href="structvxlan__s.html#a6d8b46cddca08debd4645f38e008dab5">tunnel_term_gport</a>, g_vxlan.<a class="code" href="structvxlan__s.html#abb2535de38a9772d1086c307e988d1da">prov_vlan_l3_intf_id</a>);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    }</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="comment">/* build l2 vxlan ports */</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    vxlan_port_add.<a class="code" href="structvxlan__port__add__s.html#a3c72b692b025ba9c797e178e6df99ec1">network_group_id</a> = g_vxlan.<a class="code" href="structvxlan__s.html#a9b5e69181be2bfb6c9dd27d2ceb6b01a">vxlan_network_group_id</a>;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="comment">/* create VxLAN gport using tunnel inlif */</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  vxlan_port_add.<a class="code" href="structvxlan__port__add__s.html#a871ac564d33b78b193bba71ab8007acb">vpn</a>         = <a class="code" href="structvxlan__s.html#ad86bc71950683d29530ca040aaf545fe">vpn_id</a>;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  vxlan_port_add.<a class="code" href="structvxlan__port__add__s.html#aa63b6f1c4a3906da1dd79446e2606d30">in_port</a>     = <a class="code" href="structvxlan__s.html#a920ac099de8959b39b8f02076afd837f">network_port</a>;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  vxlan_port_add.<a class="code" href="structvxlan__port__add__s.html#ab32e0326829e5a9ebd5437a924286e9f">in_tunnel</a>   = g_vxlan.<a class="code" href="structvxlan__s.html#a6d8b46cddca08debd4645f38e008dab5">tunnel_term_gport</a>;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  vxlan_port_add.<a class="code" href="structvxlan__port__add__s.html#a15fadc6bc382fbd97c2b669987ce0c5e">out_tunnel</a>  = g_vxlan.<a class="code" href="structvxlan__s.html#a7dde8b90deec0c176991dbff88289f35">tunnel_init_gport</a>;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  vxlan_port_add.<a class="code" href="structvxlan__port__add__s.html#a79ce4d83e6ef740255e7a2c76c8a05ad">egress_if</a>   = g_vxlan.<a class="code" href="structvxlan__s.html#a8bb65f9081317e27044d587510e2fed7">vxlan_fec_intf_id</a>;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  vxlan_port_add.<a class="code" href="structvxlan__port__add__s.html#a65c03fc2e80c752f9caa54e9e4c7eb48">flags</a>       = vxlan_port_flags;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#a7ed94e934f01fbde62c6d0d5ce55ac95" title="To create VxLAN port.">example_vxlan_port_add</a>(unit, &amp;vxlan_port_add);</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    printf(<span class="stringliteral">&quot;Failed to add vxlan tunnel, in_gport=0x%08x --&gt; out_intf=0x%08x, &quot;</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        <span class="stringliteral">&quot;Error %s\n&quot;</span>, g_vxlan.<a class="code" href="structvxlan__s.html#a6d8b46cddca08debd4645f38e008dab5">tunnel_term_gport</a>,</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        g_vxlan.<a class="code" href="structvxlan__s.html#a8bb65f9081317e27044d587510e2fed7">vxlan_fec_intf_id</a>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  }</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  g_vxlan.<a class="code" href="structvxlan__s.html#ac0d9f56dd4557107733a1a6dcc480a0c">vxlan_gport</a> = vxlan_port_add.<a class="code" href="structvxlan__port__add__s.html#a2d496e06482a0c065da46ceb7fe2f9c3">vxlan_port_id</a>;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dpp_2example__vxlan_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a> &gt;= 2) {</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    printf(<span class="stringliteral">&quot;vxlan port created, vxlan_port_id: 0x%08x \n&quot;</span>, g_vxlan.<a class="code" href="structvxlan__s.html#ac0d9f56dd4557107733a1a6dcc480a0c">vxlan_gport</a>);</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <span class="comment">/* add mact entries point to created gports */</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#a6ff8a48e7bde727289c04b10bcea2197" title="To update MAC table.">example_l2_addr_add</a>(unit, g_vxlan.<a class="code" href="structvxlan__s.html#a7248861a4911aa922e37411fb4df449a">user_mac_address</a>, vpn_id, g_vxlan.<a class="code" href="structvxlan__s.html#a216de94dfb7c6b4dee49c39ac0d075d5">vlan_inLif</a>);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    printf(<span class="stringliteral">&quot;Failed to update FDB for vlan %d port 0x%08x, Error %s\n&quot;</span>,</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        vpn_id, g_vxlan.<a class="code" href="structvxlan__s.html#a216de94dfb7c6b4dee49c39ac0d075d5">vlan_inLif</a>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  rv = <a class="code" href="dpp_2example__vxlan_8c.html#a6ff8a48e7bde727289c04b10bcea2197" title="To update MAC table.">example_l2_addr_add</a>(unit, g_vxlan.<a class="code" href="structvxlan__s.html#ae0340b7e4b5b4b5026ab10c4aace77f4">tunnel_mac_address</a>, vpn_id, g_vxlan.<a class="code" href="structvxlan__s.html#ac0d9f56dd4557107733a1a6dcc480a0c">vxlan_gport</a>);</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    printf(<span class="stringliteral">&quot;Failed to update FDB for vlan %d port 0x%08x, Error %s\n&quot;</span>,</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        vpn_id, g_vxlan.<a class="code" href="structvxlan__s.html#ac0d9f56dd4557107733a1a6dcc480a0c">vxlan_gport</a>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  }</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  <span class="comment">/* adding a registered MC using flood MC */</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  <a class="code" href="structopennsl__l2__addr__s.html" title="Device-independent L2 address structure.">opennsl_l2_addr_t</a> l2addr;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  <a class="code" href="group__l2.html#ga47e819cf5939a8e643ad09505df52071" title="Initialize an L2 address structure to a specified MAC address and VLAN ID.">opennsl_l2_addr_t_init</a>(&amp;l2addr, g_vxlan.<a class="code" href="structvxlan__s.html#af238f93ae76db66e5d353eb48d21aa14">mc_mac</a>, vpn_id);</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  l2addr.<a class="code" href="structopennsl__l2__addr__s.html#a51d440393de19ef5a74d851d252f16e6" title="XGS: index in L2MC table.">l2mc_group</a> = g_vxlan.<a class="code" href="structvxlan__s.html#a1b647ccd563354898062549280703bb9">mc_group_id</a>;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  l2addr.<a class="code" href="structopennsl__l2__addr__s.html#a3c915015c746bbad9799b9a40a51b829" title="OPENNSL_L2_xxx flags.">flags</a>      = <a class="code" href="group__l2.html#ga838d2e1cee40e3ae41cd4a59599dd333">OPENNSL_L2_STATIC</a> | <a class="code" href="group__l2.html#gaff302c3bc44f98cd482238b9360c01bd">OPENNSL_L2_MCAST</a>;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  rv = <a class="code" href="group__l2.html#ga4b8920c1c3cf4c0c59bf8f0c5890f7c5" title="Add an L2 address entry to the specified device.">opennsl_l2_addr_add</a>(unit, &amp;l2addr);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    printf(<span class="stringliteral">&quot;Failed to FDB with multicast entry, Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  }</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;}</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment">/*****************************************************************/</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"><a class="code" href="dpp_2example__vxlan_8c.html#a0ddf1224851353fc92bfbff6f499fa97"> 1551</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="example__cos_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function for policer application.">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;{</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <a class="code" href="group__error.html#gac798c5c818a3213c27d2900d47add7f9" title="OPENNSL API error codes.">opennsl_error_t</a>   rv;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <span class="keywordtype">int</span> choice;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <span class="keywordtype">int</span> index = 0;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="keywordtype">int</span> unit = <a class="code" href="dpp_2example__vxlan_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">DEFAULT_UNIT</a>;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <span class="keywordtype">int</span> port_a;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="keywordtype">int</span> port_n;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structvxlan__s.html#ad86bc71950683d29530ca040aaf545fe">vpn_id</a>;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  <span class="keywordflow">if</span>(strcmp(argv[0], <span class="stringliteral">&quot;gdb&quot;</span>) == 0)</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  {</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    index = 1;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  }</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <span class="keywordflow">if</span>((argc != (index + 1)) || ((argc &gt; (index + 1)) &amp;&amp; (strcmp(argv[index + 1], <span class="stringliteral">&quot;--help&quot;</span>) == 0))) {</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    printf(<span class="stringliteral">&quot;%s\n\r&quot;</span>, <a class="code" href="example__cos_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">example_usage</a>);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a8b380efdb47b4a4b0ebafbb1c7823748">OPENNSL_E_PARAM</a>;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  }</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="comment">/* Initialize the system. */</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  printf(<span class="stringliteral">&quot;Initializing the switch device.\r\n&quot;</span>);</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  rv = <a class="code" href="driver_8h.html#a06a6fe41f5ea8664c461423d3cad0923" title="Function to initialize the switch.">opennsl_driver_init</a>((<a class="code" href="structopennsl__config__s.html">opennsl_init_t</a> *) <a class="code" href="sal_2types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <span class="keywordflow">if</span>(rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    printf(<span class="stringliteral">&quot;\r\nFailed to initialize the switch device. Error %s\r\n&quot;</span>,</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  }</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  <span class="comment">/* cold boot initialization commands */</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  rv = <a class="code" href="examples_2util_8h.html#a2846e8ec8f46d212a3ae2493bdff7980" title="Set default configuration (like STP state, speed/duplex) for all ports.">example_port_default_config</a>(unit);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    printf(<span class="stringliteral">&quot;\r\nFailed to apply default config on ports, rv = %d (%s).\r\n&quot;</span>,</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        rv, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  }</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  <span class="keywordflow">while</span> (1) {</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    printf(<span class="stringliteral">&quot;\r\nUser menu: Select one of the following options\r\n&quot;</span>);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    printf(<span class="stringliteral">&quot;1. Configure VxLAN segment\n&quot;</span>);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="preprocessor">#ifdef INCLUDE_DIAG_SHELL</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;9. Launch diagnostic shell\n&quot;</span>);</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;0. Quit the application\n&quot;</span>);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;choice) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;      printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    }</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keywordflow">switch</span>(choice){</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        {</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;          <span class="comment">/* Configure VXLAN settings for access and network ports */</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;          printf(<span class="stringliteral">&quot;a. Enter Access port number\n&quot;</span>);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;port_a) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;          {</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;          }</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;          printf(<span class="stringliteral">&quot;b. Enter Network port number\n&quot;</span>);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;port_n) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;          {</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;          }</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;          printf(<span class="stringliteral">&quot;c. Enter VPN ID (Ex: 9216)\n&quot;</span>);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;vpn_id) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;          {</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;            printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;          }</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;          rv = <a class="code" href="dpp_2example__vxlan_8c.html#a5bd99907b1249af4dc595c4d17b727b3" title="Main function to build VxLAN IP tunnel.">example_vxlan</a>(unit, port_n, port_a, vpn_id); </div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;          <span class="keywordflow">if</span>(rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;          {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;            printf(<span class="stringliteral">&quot;\r\nVxLAN configuration has failed.\n&quot;</span>);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;            <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;          }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;          printf(<span class="stringliteral">&quot;\r\nVxLAN configuration is done successfully\n&quot;</span>);</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        }</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="preprocessor">#ifdef INCLUDE_DIAG_SHELL</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">case</span> 9:</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        {</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;          opennsl_driver_shell();</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;      <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        {</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;          printf(<span class="stringliteral">&quot;Exiting the application.\n&quot;</span>);</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;          rv = <a class="code" href="driver_8h.html#aa760e8f1af45c7fd27ec014b82c572f2" title="Function to free up the resources and exit the driver.">opennsl_driver_exit</a>();</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;          <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        }</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    } <span class="comment">/* End of switch */</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  } <span class="comment">/* End of while */</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;}</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="comment">/* __doxy_func_body_end__ */</span></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<!--BEGIN GENERATE_TREEVIEW -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<hr>
<p>	
<table class="footer-brcm">
	<tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align=left></td>
		<td class="footer-brcm"><small><b>&copy;  2016-17 by Broadcom Limited. All rights reserved.</b></small>
			<div class="footer-brcm"><small>Broadcom Limited reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design. 
Information furnished by Broadcom Limited is believed to be accurate and reliable. However, Broadcom Limited does not assume any liability arising 
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license 
under its patent rights nor the rights of others. </small>
			</div>
		</td>
	</tr>
</table>	
</p>	
</div>
<!--END GENERATE_TREEVIEW-->
</body>
</html>
